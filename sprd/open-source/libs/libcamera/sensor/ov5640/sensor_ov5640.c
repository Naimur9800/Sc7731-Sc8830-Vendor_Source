/*
 * Copyright (C) 2012 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
#define LOG_TAG __FILE__
#include <utils/Log.h>
#include "sensor.h"
#include "jpeg_exif_header.h"
#include "sensor_drv_u.h"
#include "cmr_oem.h"

#define ov5640_I2C_ADDR_W        0x3c
#define ov5640_I2C_ADDR_R         0x3c
#define FOCUS_ZONE_W 80
#define FOCUS_ZONE_H 60
#define AUTOFOCUS_TIMEOUT (280)
#define FOCUS_MOVE_GAIN_CHECK 10000
#ifndef ABS
#define ABS(x)  (((x) < 0) ? (-(x)):(x))
#endif
#define EXPOSURE_ZONE_W 1280
#define EXPOSURE_ZONE_H 960
#define CMD_MAIN 0x3022
#define CMD_ACK 0x3023
#define CMD_PARAM0 0x3024
#define CMD_PARAM1 0x3025
#define CMD_PARAM2 0x3026
#define CMD_PARAM3 0x3027
#define CMD_PARAM4 0x3028
static uint32_t ae_low = 0, ae_high = 0, ae_target = 0;
static uint32_t preview_sysclk;
static int s_ov5640_gain = 0;
static int s_ov5640_gain_bak = 0;
static int s_ov5640_shutter_bak = 0;
static int s_capture_shutter = 0;
static int s_capture_VTS = 0;
static uint32_t s_af_gain = 0;
static uint32_t s_is_dv_mode = 0;
static uint32_t iso_mode = 0;
static uint32_t preview_hts;
static EXIF_SPEC_PIC_TAKING_COND_T s_ov5640_exif;
static uint32_t af_quit_flag = 0;

LOCAL uint32_t _ov5640_InitExifInfo(void);
LOCAL uint32_t _ov5640_GetResolutionTrimTab(uint32_t param);
LOCAL uint32_t _ov5640_PowerOn(uint32_t power_on);
LOCAL uint32_t _ov5640_Identify(uint32_t param);
LOCAL uint32_t _ov5640_set_brightness(uint32_t level);
LOCAL uint32_t _ov5640_set_contrast(uint32_t level);
LOCAL uint32_t _ov5640_set_saturation(uint32_t level);
LOCAL uint32_t _ov5640_set_image_effect(uint32_t effect_type);
LOCAL uint32_t _ov5640_set_ev(uint32_t level);
LOCAL uint32_t _ov5640_set_anti_flicker(uint32_t mode);
LOCAL uint32_t _ov5640_set_video_mode(uint32_t mode);
LOCAL uint32_t _ov5640_set_awb(uint32_t mode);
LOCAL uint32_t _ov5640_set_work_mode(uint32_t mode);
LOCAL uint32_t _ov5640_BeforeSnapshot(uint32_t param);
LOCAL uint32_t _ov5640_check_image_format_support(uint32_t param);
LOCAL uint32_t _ov5640_pick_out_jpeg_stream(uint32_t param);
LOCAL uint32_t _ov5640_after_snapshot(uint32_t param);
LOCAL uint32_t _ov5640_GetExifInfo(uint32_t param);
LOCAL uint32_t _ov5640_ExtFunc(uint32_t ctl_param);
LOCAL uint32_t _ov5640_check_status(uint32_t param);
LOCAL uint32_t _ov5640_get_cur_af_gain(void);
LOCAL uint32_t _ov5640_set_iso(uint32_t mode);
LOCAL uint32_t _ov5640_ReadGain(uint32_t param);
LOCAL uint32_t _ov5640_flash(uint32_t param);
LOCAL int _ov5640_init_firmware(void);
LOCAL uint32_t _ov5640_StreamOn(uint32_t param);
LOCAL uint32_t _ov5640_StreamOff(uint32_t param);

LOCAL const SENSOR_REG_T ov5640_640X480[] = {
	{0x4202, 0x0f},		/*kenxu add 20120207 for stream off*/
	{SENSOR_WRITE_DELAY, 0x10},
	{0x3c07, 0x08},		/* lightmeter 1 threshold[7:0]*/
	{0x3820, 0x41},		/* flip*/
	{0x3821, 0x07},		/* mirror*/
	{0x3814, 0x31},		/* timing X inc*/
	{0x3815, 0x31},		/* timing Y inc*/
	{0x3800, 0x00},		/* HS*/
	{0x3801, 0x00},		/* HS*/
	{0x3802, 0x00},		/* VS*/
	{0x3803, 0x04},		/* VS*/
	{0x3804, 0x0a},		/* HW (HE)*/
	{0x3805, 0x3f},		/* HW (HE)*/
	{0x3806, 0x07},		/* VH (VE)*/
	{0x3807, 0x9b},		/* VH (VE)*/
	{0x3808, 0x02},		/* DVPHO*/
	{0x3809, 0x80},		/* DVPHO*/
	{0x380a, 0x01},		/* DVPVO*/
	{0x380b, 0xe0},		/* DVPVO*/
	{0x380c, 0x07},		/* HTS*/
	{0x380d, 0x68},		/* HTS*/
	{0x380e, 0x03},		/* VTS*/
	{0x380f, 0xd8},		/* VTS*/
	{0x3813, 0x06},		/* timing V offset*/
	{0x3618, 0x00},
	{0x3612, 0x29},
	{0x3709, 0x52},
	{0x370c, 0x03},
	{0x3a02, 0x0b},		/* 60Hz max exposure, night mode 5fps*/
	{0x3a03, 0x88},		/* 60Hz max exposure*/
	{0x3a14, 0x0b},		/* 50Hz max exposure, night mode 5fps*/
	{0x3a15, 0x88},		/* 50Hz max exposure*/
	{0x4004, 0x02},		/* BLC line number*/
	{0x3002, 0x1c},		/* reset JFIFO, SFIFO, JPG*/
	{0x3006, 0xc3},		/* disable clock of JPEG2x, JPEG*/
	{0x4713, 0x03},		/* JPEG mode 3*/
	{0x4407, 0x04},		/* Quantization sacle*/
	{0x460b, 0x35},
	{0x460c, 0x22},
	{0x4837, 0x22},		/* MIPI global timing*/
	{0x3824, 0x02},		/* PCLK manual divider*/
	{0x5001, 0xa3},		/* SDE on, CMX on, AWB on*/

	{0x3034, 0x1a},
	{0x3035, 0x21},		/* MIPI global timing*//*0x11-->30fps; 0x21-->15fps*/
	{0x3036, 0x46},		/* PCLK manual divider*/
	{0x3037, 0x14},		/* SDE on, CMX on, AWB on*/

	{0x3406, 0x00},		/*awb auto*/

	{0x3503, 0x00},		/* AEC/AGC on*/
	{0x4202, 0x00},		/*kenxu add 20120207 for stream on*/

#define  COLORBAR 0
#if COLORBAR
	{0x503d, 0x8c},
	{0x4741, 0x00},
#endif
};

LOCAL const SENSOR_REG_T ov5640_common_init[] = {
	{0x4202, 0x0f},/*kenxu add 20120207 for stream off*/
	{SENSOR_WRITE_DELAY, 0x10},
	{0x3103, 0x11},		/* sysclk from pad*/
	{0x3008, 0x82},		/*software reset*/
	{SENSOR_WRITE_DELAY, 0x20},
	{0x3008, 0x42},		/*software power down*/
	{0x3103, 0x03},		/*sysclk from pll*/
	{0x3017, 0xff},		/*Frex, Vsync, Href, PCLK, D[9:6] output*/
	{0x3018, 0xff},		/*D[5:0], GPIO[1:0] output*/
	/*{0x3031, 0x08}, *//*kenxu add 20120201 for external 1.5v dvdd @ 2.8v DOVDD*/
	{0x3034, 0x1a},
	{0x3035, 0x11},		/*0x11-->30fps; 0x21-->15fps*/
	{0x3036, 0x46},
	{0x3037, 0x13},
	{0x3108, 0x01},		/* clock divider*/
	{0x3630, 0x36},
	{0x3631, 0x0e},
	{0x3632, 0xe2},
	{0x3633, 0x12},
	{0x3621, 0xe0},
	{0x3704, 0xa0},
	{0x3703, 0x5a},
	{0x3715, 0x78},
	{0x3717, 0x01},
	{0x370b, 0x60},
	{0x3705, 0x1a},
	{0x3905, 0x02},
	{0x3906, 0x10},
	{0x3901, 0x0a},
	{0x3731, 0x12},
	{0x3600, 0x08},		/*VCM debug*/
	{0x3601, 0x33},		/*VCM debug*/
	{0x302d, 0x60},		/*system control*/
	{0x3620, 0x52},
	{0x371b, 0x20},
	{0x471c, 0x50},
	{0x3a13, 0x43},		/*pre-gain = 1.05x*/
#if 0
	{0x3a18, 0x00},		// AEC gain ceiling = 7.75x
	{0x3a19, 0x7c},		// AEC gain ceiling
#else
	{0x3a18, 0x00},		/*gain ceiling*/
	{0x3a19, 0xf8},
#endif
	{0x3635, 0x13},
	{0x3636, 0x03},
	{0x3634, 0x40},
	{0x3622, 0x01},

	/*50/60Hz detection*/
	{0x3c01, 0x34},		/* sum auto, band counter enable, threshold = 4*/
	{0x3c04, 0x28},		/* threshold low sum*/
	{0x3c05, 0x98},		/* threshold high sum*/
	{0x3c06, 0x00},		/* light meter 1 threshold H*/
	{0x3c07, 0x07},		/* light meter 1 threshold L*/
	{0x3c08, 0x00},		/* light meter 2 threshold H*/
	{0x3c09, 0x1c},		/* light meter 2 threshold L*/
	{0x3c0a, 0x9c},		/* sample number H*/
	{0x3c0b, 0x40},		/* sample number L*/
	{0x3810, 0x00},		/* X offset*/
	{0x3811, 0x10},		/* X offset*/
	{0x3812, 0x00},		/* Y offset*/
	{0x3708, 0x64},
	{0x4001, 0x02},		/* BLC start line*/
	{0x4005, 0x1a},		/* BLC always update*/
	{0x3000, 0x00},		/* enable MCU, OTP*/
	{0x3004, 0xff},		/* enable BIST, MCU memory, MCU, OTP, STROBE, D5060, timing, array clock*/
	{0x300e, 0x58},		/* MIPI 2 lane? power down PHY HS TX, PHY LP RX, DVP enable*/
	{0x302e, 0x00},
	{0x4300, 0x30},		/* YUV 422, YUYV*/
	{0x501f, 0x00},		/* ISP YUV 422*/
	{0x440e, 0x00},
	{0x5000, 0xa7},		/* LENC on, raw gamma on, BPC on, WPC on, CIP on*/

	/*AEC target*/
#if 0
	{0x3a0f, 0x30},		// stable in high
	{0x3a10, 0x28},		// stable in low
	{0x3a1b, 0x30},		// stable out high
	{0x3a1e, 0x26},		// stable out low
	{0x3a11, 0x60},		// fast zone high
	{0x3a1f, 0x14},		// fast zone low
#else
	{0x3a0f, 0x38},		/*ae target*/
	{0x3a10, 0x30},
	{0x3a11, 0x61},
	{0x3a1b, 0x38},
	{0x3a1e, 0x30},
	{0x3a1f, 0x10},
#endif

	/*LENC*/
#if 0
	{0x5800, 0x23},
	{0x5801, 0x14},
	{0x5802, 0x0f},
	{0x5803, 0x0f},
	{0x5804, 0x12},
	{0x5805, 0x26},
	{0x5806, 0x0c},
	{0x5807, 0x08},
	{0x5808, 0x05},
	{0x5809, 0x05},
	{0x580a, 0x08},
	{0x580b, 0x0d},
	{0x580c, 0x08},
	{0x580d, 0x03},
	{0x580e, 0x00},
	{0x580f, 0x00},
	{0x5810, 0x03},
	{0x5811, 0x09},
	{0x5812, 0x07},
	{0x5813, 0x03},
	{0x5814, 0x00},
	{0x5815, 0x01},
	{0x5816, 0x03},
	{0x5817, 0x08},
	{0x5818, 0x0d},
	{0x5819, 0x08},
	{0x581a, 0x05},
	{0x581b, 0x06},
	{0x581c, 0x08},
	{0x581d, 0x0e},
	{0x581e, 0x29},
	{0x581f, 0x17},
	{0x5820, 0x11},
	{0x5821, 0x11},
	{0x5822, 0x15},
	{0x5823, 0x28},
	{0x5824, 0x46},
	{0x5825, 0x26},
	{0x5826, 0x08},
	{0x5827, 0x26},
	{0x5828, 0x64},
	{0x5829, 0x26},
	{0x582a, 0x24},
	{0x582b, 0x22},
	{0x582c, 0x24},
	{0x582d, 0x24},
	{0x582e, 0x06},
	{0x582f, 0x22},
	{0x5830, 0x40},
	{0x5831, 0x42},
	{0x5832, 0x24},
	{0x5833, 0x26},
	{0x5834, 0x24},
	{0x5835, 0x22},
	{0x5836, 0x22},
	{0x5837, 0x26},
	{0x5838, 0x44},
	{0x5839, 0x24},
	{0x583a, 0x26},
	{0x583b, 0x28},
	{0x583c, 0x42},
	{0x583d, 0xce},		// LENC BR offset
#else
	{0x5800, 0x34},		/*lenc*/
	{0x5801, 0x17},
	{0x5802, 0x11},
	{0x5803, 0x11},
	{0x5804, 0x18},
	{0x5805, 0x35},
	{0x5806, 0x0E},
	{0x5807, 0x09},
	{0x5808, 0x06},
	{0x5809, 0x06},
	{0x580A, 0x08},
	{0x580B, 0x0E},
	{0x580C, 0x0A},
	{0x580D, 0x04},
	{0x580E, 0x00},
	{0x580F, 0x00},
	{0x5810, 0x04},
	{0x5811, 0x09},
	{0x5812, 0x0A},
	{0x5813, 0x04},
	{0x5814, 0x00},
	{0x5815, 0x00},
	{0x5816, 0x04},
	{0x5817, 0x09},
	{0x5818, 0x0D},
	{0x5819, 0x09},
	{0x581A, 0x07},
	{0x581B, 0x06},
	{0x581C, 0x08},
	{0x581D, 0x0D},
	{0x581E, 0x33},
	{0x581F, 0x16},
	{0x5820, 0x11},
	{0x5821, 0x10},
	{0x5822, 0x16},
	{0x5823, 0x34},
	{0x5824, 0x58},
	{0x5825, 0x38},
	{0x5826, 0x18},
	{0x5827, 0x38},
	{0x5828, 0x48},
	{0x5829, 0x29},
	{0x582A, 0x25},
	{0x582B, 0x25},
	{0x582C, 0x24},
	{0x582D, 0x27},
	{0x582E, 0x06},
	{0x582F, 0x42},
	{0x5830, 0x50},
	{0x5831, 0x42},
	{0x5832, 0x05},
	{0x5833, 0x17},
	{0x5834, 0x14},
	{0x5835, 0x13},
	{0x5836, 0x14},
	{0x5837, 0x16},
	{0x5838, 0x68},
	{0x5839, 0x38},
	{0x583A, 0x17},
	{0x583B, 0x37},
	{0x583C, 0x68},
	{0x583D, 0xCF},
#endif

	/*AWB*/
#if 0
	{0x5180, 0xff},
	{0x5181, 0xf2},
	{0x5182, 0x00},
	{0x5183, 0x14},
	{0x5184, 0x25},
	{0x5185, 0x24},
	{0x5186, 0x0e},
	{0x5187, 0x18},
	{0x5188, 0x1a},
	{0x5189, 0x7e},
	{0x518a, 0x5c},
	{0x518b, 0xda},
	{0x518c, 0xa3},
	{0x518d, 0x3f},
	{0x518e, 0x2d},
	{0x518f, 0x53},
	{0x5190, 0x45},
	{0x5191, 0xf8},
	{0x5192, 0x04},
	{0x5193, 0xf0},
	{0x5194, 0xf0},
	{0x5195, 0xf0},
	{0x5196, 0x03},
	{0x5197, 0x01},
	{0x5198, 0x04},
	{0x5199, 0x21},
	{0x519a, 0x04},
	{0x519b, 0x00},
	{0x519c, 0x08},
	{0x519d, 0x9e},
	{0x519e, 0x38},
#else
	{0x5180, 0xff},		/*awb*/
	{0x5181, 0xf2},
	{0x5182, 0x0},
	{0x5183, 0x14},
	{0x5184, 0x25},
	{0x5185, 0x24},
	{0x5186, 0x0e},
	{0x5187, 0x18},
	{0x5188, 0x1a},
	{0x5189, 0x7e},
	{0x518a, 0x5c},
	{0x518b, 0xda},
	{0x518c, 0xa3},
	{0x518d, 0x3f},
	{0x518e, 0x2d},
	{0x518f, 0x53},
	{0x5190, 0x45},
	{0x5191, 0xf8},
	{0x5192, 0x4},
	{0x5193, 0xf0},
	{0x5194, 0xf0},
	{0x5195, 0xf0},
	{0x5196, 0x3},
	{0x5197, 0x1},
	{0x5198, 0x4},
	{0x5199, 0x21},
	{0x519a, 0x4},
	{0x519b, 0x0},
	{0x519c, 0x8},
	{0x519d, 0x9e},
	{0x519e, 0x38},
#endif

	/*Gamma*/
#if 0
	{0x5480, 0x01},		//BIAS plus on
	{0x5481, 0x08},
	{0x5482, 0x14},
	{0x5483, 0x28},
	{0x5484, 0x51},
	{0x5485, 0x65},
	{0x5486, 0x71},
	{0x5487, 0x7d},
	{0x5488, 0x87},
	{0x5489, 0x91},
	{0x548a, 0x9a},
	{0x548b, 0xaa},
	{0x548c, 0xb8},
	{0x548d, 0xcd},
	{0x548e, 0xdd},
	{0x548f, 0xea},
	{0x5490, 0x1d},
#else
	{0x5490, 0x1d},
	{0x5481, 0x5},
	{0x5482, 0x10},
	{0x5483, 0x25},
	{0x5484, 0x4f},
	{0x5485, 0x64},
	{0x5486, 0x71},
	{0x5487, 0x7d},
	{0x5488, 0x87},
	{0x5489, 0x91},
	{0x548a, 0x9a},
	{0x548b, 0xaa},
	{0x548c, 0xb8},
	{0x548d, 0xcd},
	{0x548e, 0xdd},
	{0x548f, 0xea},
#endif

	/*color matrix*/
#if 0
	{0x5381, 0x1e},		//CMX1 for Y
	{0x5382, 0x5b},		//CMX2 for Y
	{0x5383, 0x08},		//CMX3 for Y
	{0x5384, 0x0a},		//CMX4 for U
	{0x5385, 0x7e},		//CMX5 for U
	{0x5386, 0x88},		//CMX6 for U
	{0x5387, 0x7c},		//CMX7 for V
	{0x5388, 0x6c},		//CMX8 for V
	{0x5389, 0x10},		//CMX9 for V
	{0x538a, 0x01},		//sign[9]
	{0x538b, 0x98},		//sign[8:1]
#else
	{0x5381, 0x1c},
	{0x5382, 0x5a},
	{0x5383, 0x6},
	{0x5384, 0x8},
	{0x5385, 0x65},
	{0x5386, 0x6d},
	{0x5387, 0x7c},
	{0x5388, 0x6c},
	{0x5389, 0x10},
	{0x538b, 0x98},
	{0x538a, 0x1},
#endif

	/*UV adjust*/
#if 0
	{0x5580, 0x02},
	{0x5583, 0x40},
	{0x5584, 0x10},
	{0x5589, 0x10},
	{0x558a, 0x00},
	{0x558b, 0xf8},
	{0x501d, 0x40},		// enable manual offset in contrast

//CIP
	{0x5300, 0x08},		// sharpen-MT th1
	{0x5301, 0x30},		// sharpen-MT th2
	{0x5302, 0x10},		// sharpen-MT off1
	{0x5303, 0x00},		// sharpen-MT off2
	{0x5304, 0x08},		// De-noise th1
	{0x5305, 0x30},		// De-noise th2
	{0x5306, 0x08},		// De-noise off1
	{0x5307, 0x16},		// De-noise off2
	{0x5309, 0x08},		// sharpen-TH th1
	{0x530a, 0x30},		// sharpen-TH th2
	{0x530b, 0x04},		// sharpen-TH off1
	{0x530c, 0x06},		// sharpen-TH off2
#else
	/* Mini Q, Auto UV, Sharpness/De-noise*/
	{0x583e, 0x20},		/*max gain 2x, 0x20/2=16x*/
	{0x583f, 0x10},		/*min gain 2x, 0x10/2=8x*/
	{0x5840, 0x00},		/*mini Q, down from 0x40 to 00*/

	/* UV Adjust Auto Mode*/
	{0x5580, 0x02},		/*Sat enable*/
	{0x5588, 0x01},		/*enable UV adj*/
	{0x5583, 0x40},		/*offset high*/
	{0x5584, 0x20},		/*offset low*/
	{0x5589, 0x40},		/*gth1 8x*/
	{0x558a, 0x00},
	{0x358b, 0x80},		/*gth2 16x*/

	/* Sharpness Auto*/
	{0x5308, 0x25},
	{0x5300, 0x08},
	{0x5301, 0x20},
	{0x5302, 0x20},
	{0x5303, 0x00},
	{0x5309, 0x08},
	{0x530a, 0x20},
	{0x530b, 0x04},
	{0x530c, 0x06},

	/* De-Noise Auto*/
	{0x5304, 0x08},
	{0x5305, 0x20},
	{0x5306, 0x08},
	{0x5307, 0x16},
#endif

	{0x5025, 0x00},

	{0x3008, 0x02},		/*wake up from software power down*/
	{0x4202, 0x00},		/*kenxu add 20120207 for stream on*/
};

LOCAL const SENSOR_REG_T ov5640_640X480_new[] = {
	{0x4202, 0x0f},		/*kenxu add 20120207 for stream off*/
	{SENSOR_WRITE_DELAY, 0x10},
	{0x3c07, 0x08},		/* lightmeter 1 threshold[7:0]*/
	{0x3820, 0x41},		/* flip*/
	{0x3821, 0x07},		/* mirror*/
	{0x3814, 0x31},		/* timing X inc*/
	{0x3815, 0x31},		/* timing Y inc*/
	{0x3800, 0x00},		/* HS*/
	{0x3801, 0x00},		/* HS*/
	{0x3802, 0x00},		/* VS*/
	{0x3803, 0x04},		/* VS*/
	{0x3804, 0x0a},		/* HW (HE)*/
	{0x3805, 0x3f},		/* HW (HE)*/
	{0x3806, 0x07},		/* VH (VE)*/
	{0x3807, 0x9b},		/* VH (VE)*/
	{0x3808, 0x02},		/* DVPHO*/
	{0x3809, 0x80},		/* DVPHO*/
	{0x380a, 0x01},		/* DVPVO*/
	{0x380b, 0xe0},		/* DVPVO*/
	{0x380c, 0x07},		/* HTS*/
	{0x380d, 0x68},		/* HTS*/
	{0x380e, 0x03},		/* VTS*/
	{0x380f, 0xd8},		/* VTS*/
	{0x3813, 0x06},		/* timing V offset*/
	{0x3618, 0x00},
	{0x3612, 0x29},
	{0x3709, 0x52},
	{0x370c, 0x03},
	{0x3a02, 0x0b},		/* 60Hz max exposure, night mode 5fps*/
	{0x3a03, 0x88},		/* 60Hz max exposure*/
	{0x3a14, 0x0b},		/* 50Hz max exposure, night mode 5fps*/
	{0x3a15, 0x88},		/* 50Hz max exposure*/
	{0x4004, 0x02},		/* BLC line number*/
	{0x3002, 0x1c},		/* reset JFIFO, SFIFO, JPG*/
	{0x3006, 0xc3},		/* disable clock of JPEG2x, JPEG*/
	{0x4713, 0x03},		/* JPEG mode 3*/
	{0x4407, 0x04},		/* Quantization sacle*/
	{0x460b, 0x35},
	{0x460c, 0x22},
	{0x4837, 0x22},		/* MIPI global timing*/
	{0x3824, 0x02},		/* PCLK manual divider*/
	{0x5001, 0xa3},		/* SDE on, CMX on, AWB on*/

	{0x3034, 0x1a},
	{0x3035, 0x11},		/* MIPI global timing*/
	{0x3036, 0x46},		/* PCLK manual divider*/
	{0x3037, 0x13},		/* SDE on, CMX on, AWB on*/
	{0x3108, 0x01}, 	/* clock divider*/

	{0x3406, 0x00},		/*awb auto*/

	{0x3503, 0x00},		/* AEC/AGC on*/
	{0x4202, 0x00},		/*kenxu add 20120207 for stream on*/
};

LOCAL const SENSOR_REG_T ov5640_1280X960_YUV[] = {
	{0x4202, 0x0f}, 	/*kenxu add 20120207 for stream off*/
	{SENSOR_WRITE_DELAY, 0x10},
	{0x3c07, 0x08}, 	/* lightmeter 1 threshold[7:0]*/
	{0x3820, 0x41}, 	/* flip*/
	{0x3821, 0x07}, 	/* mirror*/
	{0x3814, 0x31}, 	/* timing X inc*/
	{0x3815, 0x31}, 	/* timing Y inc*/
	{0x3800, 0x00}, 	/* HS*/
	{0x3801, 0x00}, 	/* HS*/
	{0x3802, 0x00}, 	/* VS*/
	{0x3803, 0x04}, 	/* VS*/
	{0x3804, 0x0a}, 	/* HW (HE)*/
	{0x3805, 0x3f}, 	/* HW (HE)*/
	{0x3806, 0x07}, 	/* VH (VE)*/
	{0x3807, 0x9b}, 	/* VH (VE)*/
	{0x3808, 0x05}, 	/* DVPHO*/
	{0x3809, 0x00}, 	/* DVPHO*/
	{0x380a, 0x03}, 	/* DVPVO*/
	{0x380b, 0xc0}, 	/* DVPVO*/
	{0x380c, 0x07}, 	/* HTS*/
	{0x380d, 0x68}, 	/* HTS*/
	{0x380e, 0x03}, 	/* VTS*/
	{0x380f, 0xd8}, 	/* VTS*/
	{0x3813, 0x06}, 	/* timing V offset*/
	{0x3618, 0x00},
	{0x3612, 0x29},
	{0x3709, 0x52},
	{0x370c, 0x03},
	{0x3a02, 0x0b}, 	/* 60Hz max exposure, night mode 5fps*/
	{0x3a03, 0x88}, 	/* 60Hz max exposure*/
	{0x3a14, 0x0b}, 	/* 50Hz max exposure, night mode 5fps*/
	{0x3a15, 0x88}, 	/* 50Hz max exposure*/
	{0x4004, 0x02}, 	/* BLC line number*/
	{0x3002, 0x1c}, 	/* reset JFIFO, SFIFO, JPG*/
	{0x3006, 0xc3}, 	/* disable clock of JPEG2x, JPEG*/
	{0x4713, 0x03}, 	/* JPEG mode 3*/
	{0x4407, 0x04}, 	/* Quantization sacle*/
	{0x460b, 0x35},
	{0x460c, 0x22},
	{0x4837, 0x22}, 	/* MIPI global timing*/
	{0x3824, 0x01},		/* PCLK manual divider*/
	{0x5001, 0xa3}, 	/* SDE on, CMX on, AWB on*/

	{0x3034, 0x1a},
	{0x3035, 0x11}, 	/* MIPI global timing*/
	{0x3036, 0x46}, 	/* PCLK manual divider*/
	{0x3037, 0x13}, 	/* SDE on, CMX on, AWB on*/
	{0x3108, 0x01}, 	/* clock divider*/

	//{0x3406, 0x00}, 	/*awb auto*/
	//{0x3503, 0x00}, 	/* AEC/AGC on*/
	{0x4202, 0x00}, 	/*kenxu add 20120207 for stream on*/
};

/*1280X960  YUV   Mode*/
LOCAL const SENSOR_REG_T ov5640_1280X960[] = {
	{0x4202, 0x0f},		/*kenxu add 20120207 for stream off*/
	{SENSOR_WRITE_DELAY, 0x10},
	{0x3035, 0x11},
	{0x3036, 0x69},
	{0x3c07, 0x07},
	{0x3820, 0x40},
	{0x3814, 0x11},
	{0x3815, 0x11},
	{0x3803, 0x00},
	{0x3807, 0x9f},
	{0x3808, 0x05},
	{0x3809, 0x00},
	{0x380a, 0x03},
	{0x380b, 0xc0},
	{0x380c, 0x0b},
	{0x380d, 0x1c},
	{0x380e, 0x07},
	{0x380f, 0xb0},
	{0x3813, 0x04},
	{0x3618, 0x04},
	{0x3612, 0x2b},
	{0x3708, 0x21},
	{0x3709, 0x12},
	{0x370c, 0x00},
	{0x3a02, 0x07},
	{0x3a03, 0xb0},
	{0x3a0e, 0x06},
	{0x3a0d, 0x08},
	{0x3a14, 0x07},
	{0x3a15, 0xb0},
	{0x4004, 0x06},
	{0x4713, 0x02},
	{0x4407, 0x0c},
	{0x460b, 0x37},
	{0x460c, 0x20},
	{0x3821, 0x26},
	{0x3002, 0x00},
	{0x3006, 0xff},
	{0x4713, 0x02},
	{0x3824, 0x04},
	{0x4202, 0x00}	/*kenxu add 20120207 for stream on*/
};

 /*1600x1200  YUV   Mode*/
LOCAL const SENSOR_REG_T ov5640_1600X1200_YUV[] = {
	{0x3800, 0x00},		/* HS*/
	{0x3801, 0x00},		/* HS*/
	{0x3802, 0x00},		/* VS*/
	{0x3803, 0x00},		/* VS*/
	{0x3804, 0x0a},		/* HW (HE*/
	{0x3805, 0x3f},		/* HW (HE*/
	{0x3806, 0x07},		/* VH (VE*/
	{0x3807, 0x9f},		/* VH (VE*/
	{0x3808, 0x06},		/* DVPHO*/
	{0x3809, 0x40},		/* DVPHO*/
	{0x380a, 0x04},		/* DVPVO*/
	{0x380b, 0xb0},		/* DVPVO*/
	{0x380c, 0x0b},		/* HTS*/
	{0x380d, 0x1c},		/* HTS*/
	{0x380e, 0x07},		/* VTS*/
	{0x380f, 0xb0},		/* VTS*/
	{0x3813, 0x04},		/* timing V offset*/
	{0x3618, 0x04},
	{0x3612, 0x2b},
	{0x3709, 0x12},
	{0x370c, 0x00},
	{0x4004, 0x06},		/* BLC line number*/
	{0x3002, 0x1c},		/* reset JFIFO, SFIFO, JPG*/
	{0x3006, 0xc3},		/* disable clock of JPEG2x, JPEG*/
	{0x4713, 0x02},		/* JPEG mode 2*/
	{0x4407, 0x0c},		/* Quantiation sacle*/
	{0x460b, 0x37},
	{0x460c, 0x20},
	{0x4837, 0x2c},		/* MIPI global timing*/
	{0x3824, 0x01},		/* PCLK manual divider*/
	{0x5001, 0x83},		/* SDE on, CMX on, AWB on, scale off*/
	{0x3035, 0x71},		/* PLL*/
	{0x3036, 0x69},		/* PLL*/
	{0x3c07, 0x07},		/* lightmeter 1 threshold[7:0]*/
	{0x3820, 0x40},		/* flip*/
	{0x3821, 0x06},		/* mirror*/
	{0x3814, 0x11},		/* timing X inc*/
	{0x3815, 0x11},		/* timing Y inc*/
	{0x5001, 0xa7},

	/*pll*/
	{0x3034, 0x1A},
	{0x3035, 0x21},		/* change from 0x11 to 0x21*/
	{0x3036, 0x69},
	{0x3037, 0x13}

	//{0x3503, 0x00}		/* AEC/AGC on*/
};

/*1600X1200  YUV   Mode*/
LOCAL const SENSOR_REG_T ov5640_1600X1200[] = {
	{0x4202, 0x0f},		/*kenxu add 20120207 for stream off*/
	{SENSOR_WRITE_DELAY, 0x10},
	{0x3035, 0x11},
	{0x3036, 0x69},
	{0x3c07, 0x07},
	{0x3820, 0x40},
	{0x3814, 0x11},
	{0x3815, 0x11},
	{0x3803, 0x00},
	{0x3807, 0x9f},
	{0x3808, 0x06},
	{0x3809, 0x40},
	{0x380a, 0x04},
	{0x380b, 0xb0},
	{0x380c, 0x0b},
	{0x380d, 0x1c},
	{0x380e, 0x07},
	{0x380f, 0xb0},
	{0x3813, 0x04},
	{0x3618, 0x04},
	{0x3612, 0x2b},
	{0x3708, 0x21},
	{0x3709, 0x12},
	{0x370c, 0x00},
	{0x3a02, 0x07},
	{0x3a03, 0xb0},
	{0x3a0e, 0x06},
	{0x3a0d, 0x08},
	{0x3a14, 0x07},
	{0x3a15, 0xb0},
	{0x4004, 0x06},
	{0x4713, 0x02},
	{0x4407, 0x0c},
	{0x460b, 0x37},
	{0x460c, 0x20},
	{0x3821, 0x26},
	{0x3002, 0x00},
	{0x3006, 0xff},
	{0x4713, 0x02},
	{0x3824, 0x04},
	{0x4202, 0x00}		/*kenxu add 20120207 for stream on*/
};

LOCAL const SENSOR_REG_T ov5640_2048X1536_YUV[] = {
	{0x3800, 0x00},		/* HS*/
	{0x3801, 0x00},		/* HS*/
	{0x3802, 0x00},		/* VS*/
	{0x3803, 0x00},		/* VS*/
	{0x3804, 0x0a},		/* HW*/
	{0x3805, 0x3f},		/* HW*/
	{0x3806, 0x07},		/* VH*/
	{0x3807, 0x9f},		/* VH*/
	{0x3808, 0x08},		/* DVPHO*/
	{0x3809, 0x00},		/* DVPHO*/
	{0x380a, 0x06},		/* DVPVO*/
	{0x380b, 0x00},		/* DVPVO*/
	{0x380c, 0x0b},		/* HTS*/
	{0x380d, 0x1c},		/* HTS*/
	{0x380e, 0x07},		/* VTS*/
	{0x380f, 0xb0},		/* VTS*/
	{0x3813, 0x04},		/* timing V offset*/
	{0x3618, 0x04},
	{0x3612, 0x2b},
	{0x3709, 0x12},
	{0x370c, 0x00},
	{0x4004, 0x06},		/* BLC line number*/
	{0x3002, 0x1c},		/* reset JFIFO, SFIFO, JPG*/
	{0x3006, 0xc3},		/* disable clock of JPEG2x, JPEG*/
	{0x4713, 0x02},		/* JPEG mode 2*/
	{0x4407, 0x0c},		/* Quantiation sacle*/
	{0x460b, 0x37},
	{0x460c, 0x20},
	{0x4837, 0x2c},		/* MIPI global timing*/
	{0x3824, 0x01},		/* PCLK manual divider*/
	{0x5001, 0x83},		/* SDE on, CMX on, AWB on, scale off*/
	{0x3035, 0x21},		/* PLL*/
	{0x3036, 0x69},		/* PLL*/
	{0x3c07, 0x07},		/* lightmeter 1 threshold[7:0]*/
	{0x3820, 0x40},		/* flip*/
	{0x3821, 0x06},		/* mirror*/
	{0x3814, 0x11},		/* timing X inc*/
	{0x3815, 0x11},		/* timing Y inc*/
	//{0x3503, 0x00},		/* AEC/AGC on*/
	{0x5001, 0xa7}
};

/*20480X1536  JPG   Mode*/
LOCAL const SENSOR_REG_T ov5640_2048X1536[] = {
	{0x4202, 0x0f},		/*kenxu add 20120207 for stream off*/
	{SENSOR_WRITE_DELAY, 0x10},
	{0x3035, 0x11},
	{0x3036, 0x69},
	{0x3c07, 0x07},
	{0x3820, 0x40},
	{0x3814, 0x11},
	{0x3815, 0x11},
	{0x3803, 0x00},
	{0x3807, 0x9f},
	{0x3808, 0x08},
	{0x3809, 0x00},
	{0x380a, 0x06},
	{0x380b, 0x00},
	{0x380c, 0x0b},
	{0x380d, 0x1c},
	{0x380e, 0x07},
	{0x380f, 0xb0},
	{0x3813, 0x04},
	{0x3618, 0x04},
	{0x3612, 0x2b},
	{0x3708, 0x21},
	{0x3709, 0x12},
	{0x370c, 0x00},
	{0x3a02, 0x07},
	{0x3a03, 0xb0},
	{0x3a0e, 0x06},
	{0x3a0d, 0x08},
	{0x3a14, 0x07},
	{0x3a15, 0xb0},
	{0x4004, 0x06},
	{0x4713, 0x02},
	{0x4407, 0x0c},
	{0x460b, 0x37},
	{0x460c, 0x20},
	{0x3821, 0x26},
	{0x3002, 0x00},
	{0x3006, 0xff},
	{0x4713, 0x02},
	{0x3824, 0x04},
	{0x4202, 0x00},		/*kenxu add 20120207 for stream on*/
};

/*2592X1944  JPG   Mode*/
LOCAL const SENSOR_REG_T ov5640_2592X1944[] = {
	{0x4202, 0x0f},		/*kenxu add 20120207 for stream off*/
	{SENSOR_WRITE_DELAY, 0x10},
	{0x3035, 0x11},
	{0x3036, 0x69},
	{0x3c07, 0x07},
	{0x3820, 0x40},
	{0x3814, 0x11},
	{0x3815, 0x11},
	{0x3803, 0x00},
	{0x3807, 0x9f},
	{0x3808, 0x0a},
	{0x3809, 0x20},
	{0x380a, 0x07},
	{0x380b, 0x98},
	{0x380c, 0x0b},
	{0x380d, 0x1c},
	{0x380e, 0x07},
	{0x380f, 0xb0},
	{0x3813, 0x04},
	{0x3618, 0x04},
	{0x3612, 0x2b},
	{0x3708, 0x21},
	{0x3709, 0x12},
	{0x370c, 0x00},
	{0x3a02, 0x07},
	{0x3a03, 0xb0},
	{0x3a0e, 0x06},
	{0x3a0d, 0x08},
	{0x3a14, 0x07},
	{0x3a15, 0xb0},
	{0x4004, 0x06},
	{0x4713, 0x02},
	{0x4407, 0x0c},
	{0x460b, 0x37},
	{0x460c, 0x20},
	{0x3821, 0x26},
	{0x3002, 0x00},
	{0x3006, 0xff},
	{0x4713, 0x02},
	{0x3824, 0x04},
	{0x4202, 0x00}		/*kenxu add 20120207 for stream on*/
};

LOCAL SENSOR_REG_TAB_INFO_T s_ov5640_resolution_Tab_YUV[] = {
	{ADDR_AND_LEN_OF_ARRAY(ov5640_common_init), 0, 0, 24, SENSOR_IMAGE_FORMAT_YUV422},
#if  (SC_FPGA==0)
	{ADDR_AND_LEN_OF_ARRAY(ov5640_640X480_new), 640, 480, 24, SENSOR_IMAGE_FORMAT_YUV422},
	{ADDR_AND_LEN_OF_ARRAY(ov5640_1280X960_YUV), 1280, 960, 12, SENSOR_IMAGE_FORMAT_YUV422},
	{ADDR_AND_LEN_OF_ARRAY(ov5640_1600X1200), 1600, 1200,  24, SENSOR_IMAGE_FORMAT_JPEG},
	{ADDR_AND_LEN_OF_ARRAY(ov5640_2048X1536), 2048, 1536, 24, SENSOR_IMAGE_FORMAT_JPEG},
	{ADDR_AND_LEN_OF_ARRAY(ov5640_2592X1944), 2592, 1944, 24, SENSOR_IMAGE_FORMAT_JPEG},
#else
	{ADDR_AND_LEN_OF_ARRAY(ov5640_640X480), 640, 480, 12, SENSOR_IMAGE_FORMAT_YUV422},
	{ADDR_AND_LEN_OF_ARRAY(ov5640_1280X960), 1280, 960, 24, SENSOR_IMAGE_FORMAT_JPEG},
	{ADDR_AND_LEN_OF_ARRAY(ov5640_1600X1200), 1600, 1200, 24, SENSOR_IMAGE_FORMAT_JPEG},
	/*{ADDR_AND_LEN_OF_ARRAY(ov5640_1600X1200_YUV), 1600, 1200,  24, SENSOR_IMAGE_FORMAT_YUV422},*/
	{ADDR_AND_LEN_OF_ARRAY(ov5640_2048X1536), 2048, 1536, 24, SENSOR_IMAGE_FORMAT_JPEG},
	/*{ADDR_AND_LEN_OF_ARRAY(ov5640_2048X1536_YUV), 2048, 1536,  24, SENSOR_IMAGE_FORMAT_YUV422},*/
	{ADDR_AND_LEN_OF_ARRAY(ov5640_2592X1944), 2592, 1944, 24, SENSOR_IMAGE_FORMAT_JPEG},

#endif
	{PNULL, 0, 0, 0, 0, 0},
	{PNULL, 0, 0, 0, 0, 0},
	{PNULL, 0, 0, 0, 0, 0}
};

LOCAL SENSOR_TRIM_T s_ov5640_Resolution_Trim_Tab[] = {
	{0, 0, 0, 0, 0, 0, 0, {0, 0, 0, 0}},
	{0, 0, 640, 480, 68, 56, 0, {0, 0, 640, 480}},
	{0, 0, 1280, 960, 68, 56, 0, {0, 0, 1280, 960}},
	{0, 0, 1600, 1200, 122, 42, 0, {0, 0, 1600, 1200}},
	{0, 0, 2048, 1536, 122, 42, 0, {0, 0, 2048, 1536}},
	{0, 0, 2592, 1944, 122, 42, 0, {0, 0, 2592, 1944}},
	{0, 0, 0, 0, 0, 0, 0, {0, 0, 0, 0}},
	{0, 0, 0, 0, 0, 0, 0, {0, 0, 0, 0}},
	{0, 0, 0, 0, 0, 0, 0, {0, 0, 0, 0}}
};

LOCAL SENSOR_IOCTL_FUNC_TAB_T s_ov5640_ioctl_func_tab = {
	PNULL,
	_ov5640_PowerOn,
	PNULL,
	_ov5640_Identify,

	PNULL,			// write register
	PNULL,			// read  register
	PNULL,
	_ov5640_GetResolutionTrimTab,

	// External
	PNULL,
	PNULL,
	PNULL,

	_ov5640_set_brightness,
	_ov5640_set_contrast,
	PNULL,
	PNULL,			//_ov5640_set_saturation,

	_ov5640_set_work_mode,
	_ov5640_set_image_effect,

	_ov5640_BeforeSnapshot,
	_ov5640_after_snapshot,
	_ov5640_flash,/*_ov540_flash,*/
	PNULL,
	PNULL,
	PNULL,
	PNULL,
	PNULL,
	PNULL,
	PNULL,
	PNULL,
	_ov5640_set_awb,
	PNULL,
	_ov5640_set_iso,
	_ov5640_set_ev,
	_ov5640_check_image_format_support,
	PNULL,
	PNULL,
	_ov5640_GetExifInfo,
	_ov5640_ExtFunc,
	_ov5640_set_anti_flicker,
	_ov5640_set_video_mode,
	_ov5640_pick_out_jpeg_stream,
	PNULL,  //meter_mode
	_ov5640_check_status, //get_status
	PNULL, //_ov5640_StreamOn,
	PNULL, //_ov5640_StreamOff,
	PNULL,
};

#if 0
LOCAL SENSOR_EXTEND_INFO_T g_ov5640_ext_info = {
    (SENSOR_FOCUS_TRIG| SENSOR_FOCUS_ZONE),
    (SENSOR_EXPOSURE_AUTO|  SENSOR_EXPOSURE_ZONE)
};
#endif

LOCAL const SENSOR_REG_T s_ov5640_640x480_video_tab[SENSOR_VIDEO_MODE_MAX][1] = {
	/*video mode 0: ?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 1:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 2:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 3:?fps*/
	{
		{0xffff, 0xff}
	}
};

LOCAL const SENSOR_REG_T s_ov5640_1280x960_video_tab[SENSOR_VIDEO_MODE_MAX][1] = {
	/*video mode 0: ?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 1:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 2:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 3:?fps*/
	{
		{0xffff, 0xff}
	}
};

LOCAL const SENSOR_REG_T s_ov5640_1600x1200_video_tab[SENSOR_VIDEO_MODE_MAX][1] = {
	/*video mode 0: ?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 1:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 2:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 3:?fps*/
	{
		{0xffff, 0xff}
	}
};

LOCAL const SENSOR_REG_T s_ov5640_2048x1536_video_tab[SENSOR_VIDEO_MODE_MAX][1] = {
	/*video mode 0: ?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 1:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 2:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 3:?fps*/
	{
		{0xffff, 0xff}
	}
};

LOCAL const SENSOR_REG_T s_ov5640_2592x1944_video_tab[SENSOR_VIDEO_MODE_MAX][1] = {
	/*video mode 0: ?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 1:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 2:?fps*/
	{
		{0xffff, 0xff}
	},
	/* video mode 3:?fps*/
	{
		{0xffff, 0xff}
	}
};

LOCAL SENSOR_VIDEO_INFO_T s_ov5640_video_info[] = {
	{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}, PNULL},
	{{{30, 30, 175, 100}, {35, 35, 175, 100}, {0, 0, 0, 0}, {0, 0, 0, 0}}, (SENSOR_REG_T**)s_ov5640_640x480_video_tab},
	{{{30, 30, 219, 100}, {35, 35, 219, 100}, {0, 0, 0, 0}, {0, 0, 0, 0}}, (SENSOR_REG_T**)s_ov5640_1280x960_video_tab},
	{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}, (SENSOR_REG_T**)s_ov5640_1600x1200_video_tab},
	{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}, (SENSOR_REG_T**)s_ov5640_2048x1536_video_tab},
	{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}, (SENSOR_REG_T**)s_ov5640_2592x1944_video_tab},

	{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}, PNULL},
	{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}, PNULL},
	{{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}, PNULL}
};

SENSOR_INFO_T g_ov5640_yuv_info = {
	ov5640_I2C_ADDR_W,	// salve i2c write address
	ov5640_I2C_ADDR_R,	// salve i2c read address

	SENSOR_I2C_REG_16BIT | SENSOR_I2C_REG_8BIT | SENSOR_I2C_FREQ_400,	// bit0: 0: i2c register value is 8 bit, 1: i2c register value is 16 bit
	// bit1: 0: i2c register addr  is 8 bit, 1: i2c register addr  is 16 bit
	// other bit: reseved
	SENSOR_HW_SIGNAL_PCLK_N | SENSOR_HW_SIGNAL_VSYNC_N | SENSOR_HW_SIGNAL_HSYNC_P,	// bit0: 0:negative; 1:positive -> polarily of pixel clock
	// bit2: 0:negative; 1:positive -> polarily of horizontal synchronization signal
	// bit4: 0:negative; 1:positive -> polarily of vertical synchronization signal
	// other bit: reseved

	// preview mode
	SENSOR_ENVIROMENT_NORMAL | SENSOR_ENVIROMENT_NIGHT,

	// image effect
	SENSOR_IMAGE_EFFECT_NORMAL |
	SENSOR_IMAGE_EFFECT_BLACKWHITE |
	SENSOR_IMAGE_EFFECT_RED |
	SENSOR_IMAGE_EFFECT_GREEN |
	SENSOR_IMAGE_EFFECT_BLUE |
	SENSOR_IMAGE_EFFECT_YELLOW |
	SENSOR_IMAGE_EFFECT_NEGATIVE | SENSOR_IMAGE_EFFECT_CANVAS,

	// while balance mode
	0,

	7,			// bit[0:7]: count of step in brightness, contrast, sharpness, saturation
	// bit[8:31] reseved

	SENSOR_LOW_PULSE_RESET,	// reset pulse level
	10,			// reset pulse width(ms)

	SENSOR_HIGH_LEVEL_PWDN,	// 1: high level valid; 0: low level valid

	1,			// count of identify code
	{{0x0A, 0x56},		// supply two code to identify sensor.
	 {0x0B, 0x40}},		// for Example: index = 0-> Device id, index = 1 -> version id

	SENSOR_AVDD_2800MV,	// voltage of avdd

	2592,			// max width of source image
	1944,			// max height of source image
	"ov5640",		// name of sensor

	SENSOR_IMAGE_FORMAT_MAX,	// define in SENSOR_IMAGE_FORMAT_E enum,SENSOR_IMAGE_FORMAT_MAX
	// if set to SENSOR_IMAGE_FORMAT_MAX here, image format depent on SENSOR_REG_TAB_INFO_T

	SENSOR_IMAGE_PATTERN_YUV422_YUYV,	// pattern of input image form sensor;

	s_ov5640_resolution_Tab_YUV,	// point to resolution table information structure
	&s_ov5640_ioctl_func_tab,	// point to ioctl function table
	0,		// information and table about Rawrgb sensor
	NULL,			//&g_ov5640_ext_info,                // extend information about sensor
	SENSOR_AVDD_1800MV,	// iovdd
	SENSOR_AVDD_1500MV,	// dvdd
	1,			// skip frame num before preview
	1,			// skip frame num before capture
	0,			// deci frame num during preview
	0,			// deci frame num during video preview

	0,
	0,
	0,
	0,
	0,
	{SENSOR_INTERFACE_TYPE_CCIR601, 8, 16, 1},
	s_ov5640_video_info,
	1,			// skip frame num while change setting
	48,			// horizontal view angle
	48,			// vertical view angle
};

LOCAL uint32_t _ov5640_GetExifInfo(uint32_t param)
{
	return (uint32_t) & s_ov5640_exif;
}

LOCAL uint32_t _ov5640_InitExifInfo(void)
{
	EXIF_SPEC_PIC_TAKING_COND_T *exif_ptr = &s_ov5640_exif;

	memset(&s_ov5640_exif, 0, sizeof(EXIF_SPEC_PIC_TAKING_COND_T));

	SENSOR_PRINT("Start");

	exif_ptr->valid.FNumber = 1;
	exif_ptr->FNumber.numerator = 14;
	exif_ptr->FNumber.denominator = 5;

	exif_ptr->valid.ExposureProgram = 1;
	exif_ptr->ExposureProgram = 0x04;

	//exif_ptr->SpectralSensitivity[MAX_ASCII_STR_SIZE];
	//exif_ptr->ISOSpeedRatings;
	//exif_ptr->OECF;

	//exif_ptr->ShutterSpeedValue;

	exif_ptr->valid.ApertureValue = 1;
	exif_ptr->ApertureValue.numerator = 14;
	exif_ptr->ApertureValue.denominator = 5;

	//exif_ptr->BrightnessValue;
	//exif_ptr->ExposureBiasValue;

	exif_ptr->valid.MaxApertureValue = 1;
	exif_ptr->MaxApertureValue.numerator = 14;
	exif_ptr->MaxApertureValue.denominator = 5;

	//exif_ptr->SubjectDistance;
	//exif_ptr->MeteringMode;
	//exif_ptr->LightSource;
	//exif_ptr->Flash;

	exif_ptr->valid.FocalLength = 1;
	exif_ptr->FocalLength.numerator = 289;
	exif_ptr->FocalLength.denominator = 100;

	//exif_ptr->SubjectArea;
	//exif_ptr->FlashEnergy;
	//exif_ptr->SpatialFrequencyResponse;
	//exif_ptr->FocalPlaneXResolution;
	//exif_ptr->FocalPlaneYResolution;
	//exif_ptr->FocalPlaneResolutionUnit;
	//exif_ptr->SubjectLocation[2];
	//exif_ptr->ExposureIndex;
	//exif_ptr->SensingMethod;

	exif_ptr->valid.FileSource = 1;
	exif_ptr->FileSource = 0x03;

	//exif_ptr->SceneType;
	//exif_ptr->CFAPattern;
	//exif_ptr->CustomRendered;

	exif_ptr->valid.ExposureMode = 1;
	exif_ptr->ExposureMode = 0x00;

	exif_ptr->valid.WhiteBalance = 1;
	exif_ptr->WhiteBalance = 0x00;

	//exif_ptr->DigitalZoomRatio;
	//exif_ptr->FocalLengthIn35mmFilm;
	//exif_ptr->SceneCaptureType;
	//exif_ptr->GainControl;
	//exif_ptr->Contrast;
	//exif_ptr->Saturation;
	//exif_ptr->Sharpness;
	//exif_ptr->DeviceSettingDescription;
	//exif_ptr->SubjectDistanceRange;

	return SENSOR_SUCCESS;
}

LOCAL uint32_t _ov5640_GetResolutionTrimTab(uint32_t param)
{
	return (uint32_t) s_ov5640_Resolution_Trim_Tab;
}
LOCAL uint32_t _ov5640_PowerOn(uint32_t power_on)
{
	SENSOR_AVDD_VAL_E dvdd_val = g_ov5640_yuv_info.dvdd_val;
	SENSOR_AVDD_VAL_E avdd_val = g_ov5640_yuv_info.avdd_val;
	SENSOR_AVDD_VAL_E iovdd_val = g_ov5640_yuv_info.iovdd_val;
	BOOLEAN power_down = g_ov5640_yuv_info.power_down_level;
	BOOLEAN reset_level = g_ov5640_yuv_info.reset_pulse_level;

	SENSOR_PRINT("dvdd_val %d, dvdd_val %d, avdd_val %d, iovdd_val %d",
			power_on,
			dvdd_val,
			avdd_val,
			iovdd_val);
	SENSOR_PRINT("power_down %d reset_level %d", power_down, reset_level);

	if (SENSOR_TRUE == power_on) {
		//reset
		Sensor_SetResetLevel(reset_level);
		Sensor_PowerDown(power_down);
		usleep(10*1000);
		// Open power
		Sensor_SetIovddVoltage(iovdd_val);
		usleep(1*1000);
		Sensor_SetAvddVoltage(avdd_val);
		usleep(1*1000);
		Sensor_SetDvddVoltage(dvdd_val);
		usleep(5*1000);
		Sensor_SetMCLK(SENSOR_DEFALUT_MCLK);
		Sensor_PowerDown(!power_down);
		usleep(1*1000);
		Sensor_SetResetLevel(!reset_level);
		usleep(20*1000);
		Sensor_SetMonitorVoltage(SENSOR_AVDD_3000MV);
	} else {
		Sensor_SetMonitorVoltage(SENSOR_AVDD_CLOSED);
		Sensor_SetResetLevel(reset_level);
		usleep(1*1000);
		Sensor_SetMCLK(SENSOR_DISABLE_MCLK);
		usleep(1*1000);
		Sensor_SetDvddVoltage(SENSOR_AVDD_CLOSED);
		usleep(1*1000);
		Sensor_SetAvddVoltage(SENSOR_AVDD_CLOSED);
		usleep(1*1000);
		Sensor_SetIovddVoltage(SENSOR_AVDD_CLOSED);
		usleep(20*1000);

	}
	SENSOR_PRINT("(1:on, 0:off): %d_end\n ", power_on);
	return SENSOR_SUCCESS;
}

LOCAL uint32_t _ov5640_Identify(uint32_t param)
{
#define ov5640_PID_VALUE    0x56
#define ov5640_PID_ADDR     0x300A
#define ov5640_VER_VALUE    0x40
#define ov5640_VER_ADDR     0x300B

	uint8_t pid_value = 0x00;
	uint8_t ver_value = 0x00;
	uint32_t ret_value = SENSOR_FAIL;

	SENSOR_PRINT("SENSOR:ov5640 identify CCIR YUV .\n");

	pid_value = Sensor_ReadReg(ov5640_PID_ADDR);

	if (ov5640_PID_VALUE == pid_value) {
		ver_value = Sensor_ReadReg(ov5640_VER_ADDR);
		SENSOR_PRINT("PID = %x, VER = %x",
			     pid_value, ver_value);
		if (ov5640_VER_VALUE == ver_value) {
			ret_value = SENSOR_SUCCESS;
			SENSOR_PRINT_HIGH("SENSOR: this is ov5640 ccir yuv  sensor  ! \n");
		} else {
			SENSOR_PRINT_HIGH("this is OV%x%x sensor !", pid_value, ver_value);
		}
	} else {
		SENSOR_PRINT_ERR("identify fail,pid_value = %d ", pid_value);
	}
	_ov5640_InitExifInfo();

	return ret_value;
}

LOCAL const SENSOR_REG_BITS_T ov5640_brightness_tab[][7] = {
	{//level -3
		{0x5001, 0x80, 0x80}, {0x5587, 0x30, 0xff}, {0x5580, 0x04, 0x04},
		{0x5588, 0x08, 0x08}, {0xffff, 0xff, 0}
	},

	{//level -2
		{0x5001, 0x80, 0x80}, {0x5587, 0x20, 0xff}, {0x5580, 0x04, 0x04},
		{0x5588, 0x08, 0x08}, {0xffff, 0xff, 0}
	},

	{//level -1
		{0x5001, 0x80, 0x80}, {0x5587, 0x10, 0xff}, {0x5580, 0x04, 0x04},
		{0x5588, 0x08, 0x08}, {0xffff, 0xff, 0}
	},

	{//level 0
		{0x5001, 0x80, 0x80}, {0x5587, 0x00, 0xff}, {0x5580, 0x04, 0x04},
		{0x5588, 0x00, 0x08}, {0xffff, 0xff, 0}
	},

	{//level 1
		{0x5001, 0x80, 0x80}, {0x5587, 0x10, 0xff}, {0x5580, 0x04, 0x04},
		{0x5588, 0x00, 0x08}, {0xffff, 0xff, 0}
	},

	{//level 2
		{0x5001, 0x80, 0x80}, {0x5587, 0x20, 0xff}, {0x5580, 0x04, 0x04},
		{0x5588, 0x00, 0x08}, {0xffff, 0xff, 0}
	},

	{			//level 3
		{0x5001, 0x80, 0x80}, {0x5587, 0x30, 0xff}, {0x5580, 0x04, 0x04},
		{0x5588, 0x00, 0x08}, {0xffff, 0xff, 0}
	}
};

LOCAL uint32_t _ov5640_set_brightness(uint32_t level)
{
	uint16_t i = 0x00;
	uint32_t reg_bits = 0;
	uint32_t reg_value = 0;
	SENSOR_REG_BITS_T_PTR sensor_reg_ptr =
		(SENSOR_REG_BITS_T_PTR) ov5640_brightness_tab[level];

	if (level > 6)
		return 0;

	for (i = 0x00;
	     (0xffff != sensor_reg_ptr[i].reg_addr)
	     || (0xff != sensor_reg_ptr[i].reg_value); i++) {
		if (0xff == sensor_reg_ptr[i].reg_bits) {
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					sensor_reg_ptr[i].reg_value);
		} else {
			reg_bits = sensor_reg_ptr[i].reg_bits;
			reg_value = Sensor_ReadReg(sensor_reg_ptr[i].reg_addr);
			reg_value &= ~reg_bits;
			reg_value |= sensor_reg_ptr[i].reg_value;
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					(uint16_t) reg_value);
		}
	}

	SENSOR_PRINT("0x%02x,data=0x%x", level, reg_value);
	return 0;
}

LOCAL const SENSOR_REG_BITS_T ov5640_contrast_tab[][6] = {
	{//level -3
		{0x5001, 0x80, 0x80}, {0x5580, 0x04, 0x04}, {0x5586, 0x14, 0xff},
		{0x5585, 0x14, 0xff}, {0x5588, 0x00, 0x04}, {0xffff, 0xff, 0}
	},

	{//level -2
		{0x5001, 0x80, 0x80}, {0x5580, 0x04, 0x04}, {0x5586, 0x18, 0xff},
		{0x5585, 0x18, 0xff}, {0x5588, 0x00, 0x04}, {0xffff, 0xff, 0}
	},

	{//level -1
		{0x5001, 0x80, 0x80}, {0x5580, 0x04, 0x04}, {0x5586, 0x1c, 0xff},
		{0x5585, 0x1c, 0xff}, {0x5588, 0x00, 0x04}, {0xffff, 0xff, 0}
	},

	{//level 0
		{0x5001, 0x80, 0x80}, {0x5580, 0x04, 0x04}, {0x5586, 0x20, 0xff},
		{0x5585, 0x00, 0xff}, {0x5588, 0x00, 0x04}, {0xffff, 0xff, 0}
	},

	{//level 1
		{0x5001, 0x80, 0x80}, {0x5580, 0x04, 0x04}, {0x5586, 0x24, 0xff},
		{0x5585, 0x10, 0xff}, {0x5588, 0x00, 0x04}, {0xffff, 0xff, 0}
	},

	{//level 2
		{0x5001, 0x80, 0x80}, {0x5580, 0x04, 0x04}, {0x5586, 0x28, 0xff},
		{0x5585, 0x18, 0xff}, {0x5588, 0x00, 0x04}, {0xffff, 0xff, 0}
	},

	{//level 3
		{0x5001, 0x80, 0x80}, {0x5580, 0x04, 0x04}, {0x5586, 0x2c, 0xff},
		{0x5585, 0x1c, 0xff}, {0x5588, 0x00, 0x04}, {0xffff, 0xff, 0}
	}
};

LOCAL uint32_t _ov5640_set_contrast(uint32_t level)
{
	uint16_t i = 0x00;
	uint32_t reg_bits = 0;
	uint32_t reg_value = 0;
	SENSOR_REG_BITS_T_PTR sensor_reg_ptr =
		(SENSOR_REG_BITS_T_PTR) ov5640_contrast_tab[level];

	if (level > 6)
		return 0;

	for (i = 0x00;
	     (0xffff != sensor_reg_ptr[i].reg_addr)
	     || (0xFF != sensor_reg_ptr[i].reg_value); i++) {
		if (0xff == sensor_reg_ptr[i].reg_bits) {
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					sensor_reg_ptr[i].reg_value);
		} else {
			reg_bits = sensor_reg_ptr[i].reg_bits;
			reg_value = Sensor_ReadReg(sensor_reg_ptr[i].reg_addr);
			reg_value &= ~reg_bits;
			reg_value |= sensor_reg_ptr[i].reg_value;
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					(uint16_t) reg_value);
		}
	}
	Sensor_SetSensorExifInfo(SENSOR_EXIF_CTRL_CONTRAST, (uint32_t) level);
	SENSOR_PRINT("0x%02x,data=0x%x", level, reg_value);
	return 0;
}

LOCAL const SENSOR_REG_BITS_T ov5640_saturation_tab[][6] = {
	{
		{0x5001, 0x80, 0x80}, {0x5583, 0x10, 0xff}, {0x5584, 0x10, 0xff},
		{0x5580, 0x02, 0x02}, {0x5588, 0x40, 0x40}, {0xffff, 0xff, 0}
	},

	{
		{0x5001, 0x80, 0x80}, {0x5583, 0x20, 0xff}, {0x5584, 0x20, 0xff},
		{0x5580, 0x02, 0x02}, {0x5588, 0x40, 0x40}, {0xffff, 0xff, 0}
	},

	{
		{0x5001, 0x80, 0x80}, {0x5583, 0x30, 0xff}, {0x5584, 0x30, 0xff},
		{0x5580, 0x02, 0x02}, {0x5588, 0x40, 0x40}, {0xffff, 0xff, 0}
	},

	{
		{0x5001, 0x80, 0x80}, {0x5583, 0x40, 0xff}, {0x5584, 0x40, 0xff},
		{0x5580, 0x02, 0x02}, {0x5588, 0x40, 0x40}, {0xffff, 0xff, 0}
	},

	{
		{0x5001, 0x80, 0x80}, {0x5583, 0x50, 0xff}, {0x5584, 0x50, 0xff},
		{0x5580, 0x02, 0x02}, {0x5588, 0x40, 0x40}, {0xffff, 0xff, 0}
	},

	{
		{0x5001, 0x80, 0x80}, {0x5583, 0x60, 0xff}, {0x5584, 0x60, 0xff},
		{0x5580, 0x02, 0x02}, {0x5588, 0x40, 0x40}, {0xffff, 0xff, 0}
	},

	{
		{0x5001, 0x80, 0x80}, {0x5583, 0x70, 0xff}, {0x5584, 0x70, 0xff},
		{0x5580, 0x02, 0x02}, {0x5588, 0x40, 0x40}, {0xffff, 0xff, 0}
	}
};

LOCAL uint32_t _ov5640_set_saturation(uint32_t level)
{
	uint16_t i = 0x00;
	uint32_t reg_bits = 0;
	uint32_t reg_value = 0;
	SENSOR_REG_BITS_T_PTR sensor_reg_ptr =
		(SENSOR_REG_BITS_T_PTR) ov5640_saturation_tab[level];

	if (level > 6)
		return 0;

	for (i = 0x00;
	     (0xffff != sensor_reg_ptr[i].reg_addr)
	     || (0xFF != sensor_reg_ptr[i].reg_value); i++) {
		if (0xff == sensor_reg_ptr[i].reg_bits) {
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					sensor_reg_ptr[i].reg_value);
		} else {
			reg_bits = sensor_reg_ptr[i].reg_bits;
			reg_value = Sensor_ReadReg(sensor_reg_ptr[i].reg_addr);
			reg_value &= ~reg_bits;
			reg_value |= sensor_reg_ptr[i].reg_value;
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					(uint16_t) reg_value);
		}
	}
	SENSOR_PRINT("0x%02x,data=0x%x", level, reg_value);
	return 0;
}

LOCAL const SENSOR_REG_BITS_T ov5640_image_effect_tab[][5] = {
	// effect normal
	{
		{0x5001, 0x80, 0x80}, {0x5580, 0x00, 0x58}, {0x5583, 0x40, 0xff},
		{0x5584, 0x10, 0xff}, {0xffff, 0xff, 0}
	},
	//effect BLACKWHITE
	{
		{0x5001, 0x80, 0x80}, {0x5580, 0x18, 0x58}, {0x5583, 0x80, 0xff},
		{0x5584, 0x80, 0xff}, {0xffff, 0xff, 0}
	},
	//  effect RED(don't use)
	{
		{0x5001, 0x80, 0x80}, {0x5580, 0x18, 0x58}, {0x5583, 0x80, 0xff},
		{0x5584, 0xc0, 0xff}, {0xffff, 0xff, 0}
	},
	// effect GREEN(don't use)
	{
		{0x5001, 0x80, 0x80}, {0x5580, 0x18, 0x58}, {0x5583, 0x60, 0xff},
		{0x5584, 0x60, 0xff}, {0xffff, 0xff, 0}
	},
	// effect  BLUE(don't use)
	{
		{0x5001, 0x80, 0x80}, {0x5580, 0x18, 0x58}, {0x5583, 0xa0, 0xff},
		{0x5584, 0x40, 0xff}, {0xffff, 0xff, 0}
	},
	// effect  YELLOW(don't use)
	{
		{0x5001, 0x80, 0x80}, {0x5580, 0x18, 0x58}, {0x5583, 0x00, 0xff},
		{0x5584, 0x90, 0xff}, {0xffff, 0xff, 0}
	},
	// effect NEGATIVE
	{
		{0x5001, 0x80, 0x80}, {0x5580, 0x40, 0x58}, {0x5583, 0x40, 0xff},
		{0x5584, 0x10, 0xff}, {0xffff, 0xff, 0}
	},
	//SEPIA
	{
		{0x5001, 0x80, 0x80}, {0x5580, 0x18, 0x58}, {0x5583, 0x40, 0xff},
		{0x5584, 0xb0, 0xff}, {0xffff, 0xff, 0}
	}
};

LOCAL uint32_t _ov5640_set_image_effect(uint32_t effect_type)
{
	uint16_t i = 0x00;
	uint32_t reg_bits = 0;
	uint32_t reg_value = 0;
	SENSOR_REG_BITS_T_PTR sensor_reg_ptr =
		(SENSOR_REG_BITS_T_PTR) ov5640_image_effect_tab[effect_type];

	if (effect_type > 7)
		return 0;

	for (i = 0x00;
	     (0xffff != sensor_reg_ptr[i].reg_addr)
	     || (0xff != sensor_reg_ptr[i].reg_value); i++) {
		if (0xff == sensor_reg_ptr[i].reg_bits) {
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					sensor_reg_ptr[i].reg_value);
		} else {
			reg_bits = sensor_reg_ptr[i].reg_bits;
			reg_value = Sensor_ReadReg(sensor_reg_ptr[i].reg_addr);
			reg_value &= ~reg_bits;
			reg_value |= sensor_reg_ptr[i].reg_value;
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					(uint16_t) reg_value);
		}
	}

	SENSOR_PRINT("0x%02x,data=0x%x", effect_type, reg_value);
	return 0;
}

LOCAL const SENSOR_REG_T ov5640_ev_tab[][7] = {
	{//level -3
		{0x3a0f, 0x10}, {0x3a10, 0x08}, {0x3a11, 0x31}, {0x3a1b, 0x10},
		{0x3a1e, 0x08}, {0x3a1f, 0x00}, {0xffff, 0xff}
	},

	{//level -2
		{0x3a0f, 0x18}, {0x3a10, 0x10}, {0x3a11, 0x41}, {0x3a1b, 0x18},
		{0x3a1e, 0x10}, {0x3a1f, 0x00}, {0xffff, 0xff}
	},

	{//level -1
		{0x3a0f, 0x28}, {0x3a10, 0x20}, {0x3a11, 0x51}, {0x3a1b, 0x28},
		{0x3a1e, 0x20}, {0x3a1f, 0x10}, {0xffff, 0xff}
	},

	{//level 0
		{0x3a0f, 0x38}, {0x3a10, 0x30}, {0x3a11, 0x61}, {0x3a1b, 0x38},
		{0x3a1e, 0x30}, {0x3a1f, 0x10}, {0xffff, 0xff}
	},

	{//level 1
		{0x3a0f, 0x48}, {0x3a10, 0x40}, {0x3a11, 0x80}, {0x3a1b, 0x48},
		{0x3a1e, 0x40}, {0x3a1f, 0x20}, {0xffff, 0xff}
	},

	{//level 2
		{0x3a0f, 0x58}, {0x3a10, 0x48}, {0x3a11, 0x80}, {0x3a1b, 0x58},
		{0x3a1e, 0x48}, {0x3a1f, 0x20}, {0xffff, 0xff}
	},

	{//level 3
		{0x3a0f, 0x68}, {0x3a10, 0x58}, {0x3a11, 0x90}, {0x3a1b, 0x68},
		{0x3a1e, 0x58}, {0x3a1f, 0x30}, {0xffff, 0xff}
	}
};

LOCAL uint32_t _ov5640_set_ev(uint32_t level)
{
	SENSOR_REG_T_PTR sensor_reg_ptr =
		(SENSOR_REG_T_PTR) ov5640_ev_tab[level];
	uint16_t i = 0x00;

	if (level > 6)
		return 0;

	for (i = 0x00;
	     (0xffff != sensor_reg_ptr[i].reg_addr)
	     || (0xFF != sensor_reg_ptr[i].reg_value); i++) {
		Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
				sensor_reg_ptr[i].reg_value);
	}

	SENSOR_PRINT("0x%02x", level);
	return 0;
}

LOCAL const SENSOR_REG_T ov5640_anti_banding_flicker_tab[][10] = {
	{//50hz
		{0x3c01, 0xb4}, {0x3c00, 0x04}, {0x3a08, 0x01}, {0x3a09, 0x27},
		{0x3a0e, 0x03}, {0xffff, 0xff}
	},

	{//60hz
		{0x3c01, 0xb4}, {0x3c00, 0x00}, {0x3a0a, 0x00}, {0x3a0b, 0xf6},
		{0x3a0e, 0x04}, {0xffff, 0xff}
	}
};

LOCAL uint32_t _ov5640_set_anti_flicker(uint32_t mode)
{
	SENSOR_REG_T_PTR sensor_reg_ptr =
		(SENSOR_REG_T_PTR) ov5640_anti_banding_flicker_tab[mode];
	uint16_t i = 0x00;

	if (mode > 1)
		return 0;

	for (i = 0x00;
	     (0xffff != sensor_reg_ptr[i].reg_addr)
	     || (0xff != sensor_reg_ptr[i].reg_value); i++) {
		Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
				sensor_reg_ptr[i].reg_value);
	}
	SENSOR_PRINT("0x%02x", mode);
	return 0;
}

LOCAL const SENSOR_REG_T ov5640_video_mode_tab[][3]=
{
	/* preview mode: 30 fps*/
	{
		{0x3036, 0x46},
		{0xffff, 0xff}
	},
	/* video mode: if use 35 fps, change it to 0x50*/
	{
		{0x3036, 0x50},/* 0x50: 35fps, 0x46: 30 fps*/
		{0xffff, 0xff}
	}
};

LOCAL uint32_t _ov5640_set_video_mode(uint32_t mode)
{
	SENSOR_REG_T_PTR sensor_reg_ptr = (SENSOR_REG_T_PTR)ov5640_video_mode_tab[mode];
	uint16_t i = 0x00;

	SENSOR_PRINT("0x%02x", mode);
	s_is_dv_mode = mode;

	if (mode>1)
		return 0;
	for (i = 0x00; (0xffff != sensor_reg_ptr[i].reg_addr) || (0xff != sensor_reg_ptr[i].reg_value); i++) {
		Sensor_WriteReg(sensor_reg_ptr[i].reg_addr, sensor_reg_ptr[i].reg_value);
	}

	return 0;
}

LOCAL const SENSOR_REG_BITS_T ov5640_awb_tab[][8] = {
	//AUTO
	{
		{0x3406, 0x00, 0x01}, {0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff, 0},
		{0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff, 0}
	},
	//incandescent
	{
		{0x3406, 0x01, 0x01}, {0x3400, 0x04, 0xff}, {0x3401, 0x88, 0xff},
		{0x3402, 0x04, 0xff}, {0x3403, 0x00, 0xff}, {0x3404, 0x08, 0xff},
		{0x3405, 0xb6, 0xff}, {0xffff, 0xff, 0}
	},
	//dont' use
	{
		{0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff,0}, {0xffff,0xff,0},
		{0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff, 0}
	},
	//dont' use
	{
		{0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff,0}, {0xffff,0xff,0},
		{0xffff, 0xff, 0}, {0xffff, 0xff, 0}, {0xffff, 0xff, 0}
	},
	// tungsten
	{
		{0x3406, 0x01, 0x01}, {0x3400, 0x03, 0xff}, {0x3401, 0x10, 0xff},
		{0x3402, 0x04, 0xff}, {0x3403, 0x00, 0xff}, {0x3404, 0x08, 0xff},
		{0x3405, 0x10, 0xff}, {0xffff, 0xff, 0}
	},
	//sun
	{
		{0x3406, 0x01, 0x01}, {0x3400, 0x07, 0xff}, {0x3401, 0x02, 0xff},
		{0x3402, 0x04, 0xff}, {0x3403, 0x00, 0xff}, {0x3404, 0x05, 0xff},
		{0x3405, 0x15, 0xff}, {0xffff, 0xff, 0}
	},
	//cloudy
	{
		{0x3406, 0x01, 0x01}, {0x3400, 0x07, 0xff}, {0x3401, 0x88, 0xff},
		{0x3402, 0x04, 0xff}, {0x3403, 0x00, 0xff}, {0x3404, 0x05, 0xff},
		{0x3405, 0x00, 0xff}, {0xffff, 0xff, 0}
	}
};

LOCAL uint32_t _ov5640_set_awb(uint32_t mode)
{
	uint16_t i = 0x00;
	uint32_t reg_bits = 0;
	uint32_t reg_value = 0;
	SENSOR_REG_BITS_T_PTR sensor_reg_ptr =
		(SENSOR_REG_BITS_T_PTR) ov5640_awb_tab[mode];

	if (mode > 6)
		return 0;

	for (i = 0;
	     (0xffff != sensor_reg_ptr[i].reg_addr)
	     || (0xFF != sensor_reg_ptr[i].reg_value); i++) {
		if (0xff == sensor_reg_ptr[i].reg_bits) {
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					sensor_reg_ptr[i].reg_value);
		} else {
			reg_bits = sensor_reg_ptr[i].reg_bits;
			reg_value = Sensor_ReadReg(sensor_reg_ptr[i].reg_addr);
			reg_value &= ~reg_bits;
			reg_value |= sensor_reg_ptr[i].reg_value;
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					(uint16_t) reg_value);
		}
	}
#if 0
	if (mode == 5)
		Sensor_Reset(0);

	if (mode == 6) {
		Sensor_SetMode(0);
	}
#endif
	Sensor_SetSensorExifInfo(SENSOR_EXIF_CTRL_LIGHTSOURCE, (uint32_t) mode);
	Sensor_SetSensorExifInfo(SENSOR_EXIF_CTRL_WHITEBALANCE, (uint32_t) mode);

	SENSOR_PRINT("SENSOR: _ov5640_set_awb = 0x%02x,reg_value=0x%x", mode, reg_value);
	return 0;
}

LOCAL const SENSOR_REG_BITS_T ov5640_work_mode_tab[][30] = {
	/* Normal Mode */
	{
	 // Night mode disable
	 {0x3a00, 0x78, 0xff},	// 0x04
	 // AE Weight - Average
	 {0x501d, 0x00, 0xff},
	 {0x5688, 0x11, 0xff},
	 {0x5689, 0x11, 0xff},
	 {0x568a, 0x11, 0xff},
	 {0x568b, 0x11, 0xff},
	 {0x568c, 0x11, 0xff},
	 {0x568d, 0x11, 0xff},
	 {0x568e, 0x11, 0xff},
	 {0x568f, 0x11, 0xff},
	 // CMX
	 {0x5381, 0x1e, 0xff},
	 {0x5382, 0x5b, 0xff},
	 {0x5383, 0x08, 0xff},
	 {0x5384, 0x0a, 0xff},
	 {0x5385, 0x7e, 0xff},
	 {0x5386, 0x88, 0xff},
	 {0x5387, 0x7c, 0xff},
	 {0x5388, 0x6c, 0xff},
	 {0x5389, 0x10, 0xff},
	 {0x538a, 0x01, 0xff},
	 {0x538b, 0x98, 0xff},
	 //normal fix 25fps
	 {0x3a14, 0x04, 0xff},
	 {0x3a15, 0x98, 0xff},
	 {0xFFFF, 0xFF, 0xff}
	 },

	/* Night Mode */
	{
	 //night min 12.5-25fps
	 {0x3a00, 0x7c, 0xff},
	 {0x3a14, 0x09, 0xff},
	 {0x3a15, 0x30, 0xff},
	 {0xFFFF, 0xFF, 0xff}
	 },

	/* portrait */
	{
	 // Night mode disable
	 {0x3a00, 0x78, 0xff},
	 // AE Weight - Average
	 {0x501d, 0x00, 0xff},
	 {0x5688, 0x00, 0xff},
	 {0x5689, 0x00, 0xff},
	 {0x568a, 0x10, 0xff},
	 {0x568b, 0x01, 0xff},
	 {0x568c, 0x10, 0xff},
	 {0x568d, 0x01, 0xff},
	 {0x568e, 0x00, 0xff},
	 {0x568f, 0x00, 0xff},
	 // CMX
	 {0x5381, 0x1c, 0xff},
	 {0x5382, 0x5a, 0xff},
	 {0x5383, 0x06, 0xff},
	 {0x5384, 0x08, 0xff},
	 {0x5385, 0x65, 0xff},
	 {0x5386, 0x6d, 0xff},
	 {0x5387, 0x63, 0xff},
	 {0x5388, 0x56, 0xff},
	 {0x5389, 0x0d, 0xff},
	 {0x538a, 0x01, 0xff},
	 {0x538b, 0x98, 0xff},

	 {0xFFFF, 0xFF, 0xff}
	 },

	/* landscape */
	{
	 // Night mode disable
	 {0x3a00, 0x78, 0xff},
	 // AE Weight - Average
	 {0x501d, 0x00, 0xff},
	 {0x5688, 0x11, 0xff},
	 {0x5689, 0x11, 0xff},
	 {0x568a, 0x11, 0xff},
	 {0x568b, 0x11, 0xff},
	 {0x568c, 0x11, 0xff},
	 {0x568d, 0x11, 0xff},
	 {0x568e, 0x11, 0xff},
	 {0x568f, 0x11, 0xff},
	 // CMX
	 {0x5381, 0x0b, 0xff},
	 {0x5382, 0x5f, 0xff},
	 {0x5383, 0x18, 0xff},
	 {0x5384, 0x14, 0xff},
	 {0x5385, 0x95, 0xff},
	 {0x5386, 0xab, 0xff},
	 {0x5387, 0x65, 0xff},
	 {0x5388, 0x5c, 0xff},
	 {0x5389, 0x09, 0xff},
	 {0x538a, 0x01, 0xff},
	 {0x538b, 0x98, 0xff},

	 {0xFFFF, 0xFF, 0xff}
	 },

	/* Sports */
	{
	 // Night mode disable
	 {0x3a00, 0x78, 0xff},
	 // AE Weight - Average
	 {0x501d, 0x00, 0xff},
	 {0x5688, 0x11, 0xff},
	 {0x5689, 0x11, 0xff},
	 {0x568a, 0x11, 0xff},
	 {0x568b, 0x11, 0xff},
	 {0x568c, 0x11, 0xff},
	 {0x568d, 0x11, 0xff},
	 {0x568e, 0x11, 0xff},
	 {0x568f, 0x11, 0xff},
	 // CMX
	 {0x5381, 0x1e, 0xff},
	 {0x5382, 0x5b, 0xff},
	 {0x5383, 0x08, 0xff},
	 {0x5384, 0x0a, 0xff},
	 {0x5385, 0x7e, 0xff},
	 {0x5386, 0x88, 0xff},
	 {0x5387, 0x7c, 0xff},
	 {0x5388, 0x6c, 0xff},
	 {0x5389, 0x10, 0xff},
	 {0x538a, 0x01, 0xff},
	 {0x538b, 0x98, 0xff},

	 {0xFFFF, 0xFF, 0xff}
	 },
	 /* Normal Mode */
	{
	 // Night mode disable
	 {0x3a00, 0x78, 0xff},	// 0x04
	 // AE Weight - Average
	 {0x501d, 0x00, 0xff},
	 {0x5688, 0x11, 0xff},
	 {0x5689, 0x11, 0xff},
	 {0x568a, 0x11, 0xff},
	 {0x568b, 0x11, 0xff},
	 {0x568c, 0x11, 0xff},
	 {0x568d, 0x11, 0xff},
	 {0x568e, 0x11, 0xff},
	 {0x568f, 0x11, 0xff},
	 // CMX
	 {0x5381, 0x1e, 0xff},
	 {0x5382, 0x5b, 0xff},
	 {0x5383, 0x08, 0xff},
	 {0x5384, 0x0a, 0xff},
	 {0x5385, 0x7e, 0xff},
	 {0x5386, 0x88, 0xff},
	 {0x5387, 0x7c, 0xff},
	 {0x5388, 0x6c, 0xff},
	 {0x5389, 0x10, 0xff},
	 {0x538a, 0x01, 0xff},
	 {0x538b, 0x98, 0xff},
	 //normal fix 25fps
	 {0x3a14, 0x04, 0xff},
	 {0x3a15, 0x98, 0xff},
	 {0xFFFF, 0xFF, 0xff}
	 }
};

LOCAL uint32_t _ov5640_set_work_mode(uint32_t mode)
{
	uint16_t i = 0x00;
	uint32_t reg_bits = 0;
	uint32_t reg_value = 0;
	SENSOR_REG_BITS_T_PTR sensor_reg_ptr =
		(SENSOR_REG_BITS_T_PTR) ov5640_work_mode_tab[mode];

	if (mode > 5)
		return 0;

	for (i = 0;
	     (0xffff != sensor_reg_ptr[i].reg_addr)
	     || (0xFF != sensor_reg_ptr[i].reg_value); i++) {
		if (0xff == sensor_reg_ptr[i].reg_bits) {
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					sensor_reg_ptr[i].reg_value);
		} else {
			reg_bits = sensor_reg_ptr[i].reg_bits;
			reg_value = Sensor_ReadReg(sensor_reg_ptr[i].reg_addr);
			reg_value &= ~reg_bits;
			reg_value |= sensor_reg_ptr[i].reg_value;
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr,
					(uint16_t) reg_value);
		}
	}
	Sensor_SetSensorExifInfo(SENSOR_EXIF_CTRL_SCENECAPTURETYPE, (uint32_t) mode);
	SENSOR_PRINT("SENSOR: _ov5640_set_work_mode: mode = %d", mode);
	return 0;
}

LOCAL int OV5640_get_shutter(void)
{
	// read shutter, in number of line period
	int shutter;

	shutter = (Sensor_ReadReg(0x03500) & 0x0f);
	shutter = (shutter<<8) + Sensor_ReadReg(0x3501);
	shutter = (shutter<<4) + (Sensor_ReadReg(0x3502)>>4);

	return shutter;
}

LOCAL int OV5640_get_gain16(void)
{
	// read gain, 16 = 1x
	int gain16;

	gain16 = Sensor_ReadReg(0x350a) & 0x03;
	gain16 = (gain16<<8) + Sensor_ReadReg(0x350b);

	return gain16;
}

LOCAL int OV5640_get_VTS(void)
{
	// read VTS from register settings
	int VTS;

	VTS = Sensor_ReadReg(0x380e);//total vertical size[15:8] high byte

	VTS = (VTS<<8) + Sensor_ReadReg(0x380f);

	return VTS;
}

LOCAL int OV5640_get_HTS(void)
{
	// read HTS from register settings
	int HTS;

	HTS = Sensor_ReadReg(0x380c);
	HTS = (HTS<<8) + Sensor_ReadReg(0x380d);

	return HTS;
}

LOCAL  int OV5640_get_light_frequency(void)
{
	int temp, temp1, light_frequency;

	temp = Sensor_ReadReg(0x3c01);

	if (temp & 0x80) {
		// manual
		temp1 = Sensor_ReadReg(0x3c00);
		if (temp1 & 0x04) {
			// 50Hz
			light_frequency = 50;
		} else {
			// 60Hz
			light_frequency = 60;
		}
	} else {
		// auto
		temp1 = Sensor_ReadReg(0x3c0c);
		if (temp1 & 0x01) {
			// 50Hz
			light_frequency = 50;
		} else {
		// 60Hz
			light_frequency = 50;
		}
	}
	return light_frequency;
}

LOCAL int OV5640_get_sysclk(uint32_t xclk_to_sensor)
{
	// calculate sysclk
	int temp1, temp2;
	int Multiplier, PreDiv, VCO, SysDiv, Pll_rdiv, Bit_div2x = 4, sclk_rdiv, sysclk;
	int sclk_rdiv_map[] = {1, 2, 4, 8};

	temp1 = Sensor_ReadReg(0x3034);
	temp2 = temp1 & 0x0f;
	if (temp2 == 8 || temp2 == 10) {
		Bit_div2x = temp2 / 2;
	}

	temp1 = Sensor_ReadReg(0x3035);
	SysDiv = temp1>>4;
	if(SysDiv == 0) {
		SysDiv = 16;
	}

	temp1 = Sensor_ReadReg(0x3036);
	Multiplier = temp1;

	temp1 = Sensor_ReadReg(0x3037);
	PreDiv = temp1 & 0x0f;
	Pll_rdiv = ((temp1 >> 4) & 0x01) + 1;

	temp1 = Sensor_ReadReg(0x3108);
	temp2 = temp1 & 0x03;
	sclk_rdiv = sclk_rdiv_map[temp2];

	VCO = xclk_to_sensor*100 * Multiplier / PreDiv;//if MCLK = 24M, then XVCLK = 2400

	sysclk = VCO / SysDiv / Pll_rdiv * 2 / Bit_div2x / sclk_rdiv;

	return sysclk;
}
LOCAL int OV5640_set_gain16(int gain16)
{
	// write gain, 16 = 1x
	int temp;
	gain16 = gain16 & 0x3ff;

	temp = gain16 & 0xff;
	Sensor_WriteReg(0x350b, temp);

	temp = gain16>>8;
	Sensor_WriteReg(0x350a, temp);

	return 0;
}

LOCAL int OV5640_set_shutter(int shutter)
{
	// write shutter, in number of line period
	int temp;

	shutter = shutter & 0xffff;

	temp = shutter & 0x0f;
	temp = temp<<4;
	Sensor_WriteReg(0x3502, temp);

	temp = shutter & 0xfff;
	temp = temp>>4;
	Sensor_WriteReg(0x3501, temp);

	temp = shutter>>12;
	Sensor_WriteReg(0x3500, temp);

	return 0;
}

LOCAL int OV5640_set_AE_target(int target)
{
	int fast_high, fast_low;

	ae_target = target;
	ae_low    = target * 23 / 25;	// 0.92
	ae_high   = target * 27 / 25;	// 1.08

	fast_high = ae_high << 1;
	if(fast_high>255)
		fast_high = 255;

	fast_low = ae_low >> 1;

	Sensor_WriteReg(0x3a0f, ae_high);
	Sensor_WriteReg(0x3a10, ae_low);
	Sensor_WriteReg(0x3a1b, ae_high);
	Sensor_WriteReg(0x3a1e, ae_low);
	Sensor_WriteReg(0x3a11, fast_high);
	Sensor_WriteReg(0x3a1f, fast_low);

	SENSOR_PRINT("Target ae %d, AE high %d, AE low %d", ae_target, ae_high, ae_low);
	return 0;
}

LOCAL int OV5640_set_AF_gain(uint32_t gain)
{
	s_af_gain = gain;

	return 0;
}

int OV5640_set_VTS_ori(int VTS)
{
	// write VTS to registers
	int temp;

	temp = VTS & 0xff;
	Sensor_WriteReg(0x380f, temp);

	temp = VTS>>8;
	Sensor_WriteReg(0x380e, temp);

	return 0;
}

LOCAL int OV5640_capture(uint32_t param)
{
	int ae_ag_ctrl;
	int preview_shutter, preview_gain16, average;
	int capture_shutter, capture_gain16;
	int capture_sysclk, capture_HTS, capture_VTS;
	int light_frequency, capture_bandingfilter, capture_max_band;
	long capture_gain16_shutter;

	//turn off AE/AG
	ae_ag_ctrl = Sensor_ReadReg(0x3503);
	SENSOR_PRINT("before, ae_ag_ctrl 0x%x", ae_ag_ctrl);
	ae_ag_ctrl = ae_ag_ctrl | 0x03;
	Sensor_WriteReg(0x3503, ae_ag_ctrl);
	SENSOR_PRINT("after, ae_ag_ctrl 0x%x", ae_ag_ctrl);

	// read preview shutter
	preview_shutter = OV5640_get_shutter();

	// read preview gain
	preview_gain16 = OV5640_get_gain16();

	SENSOR_PRINT("preview_shutter %d, preview_gain16 %d",
		preview_shutter,
		preview_gain16);

	// get average
	average = Sensor_ReadReg(0x56a1);

	Sensor_SetMode(param);
	Sensor_SetMode_WaitDone();

	// read capture VTS
	capture_VTS = OV5640_get_VTS();
	capture_HTS = OV5640_get_HTS();
	capture_sysclk = OV5640_get_sysclk(s_ov5640_resolution_Tab_YUV[param].xclk_to_sensor);

	SENSOR_PRINT("capture_VTS %d, capture_HTS %d, capture_sysclk %d",
		capture_VTS,
		capture_HTS,
		capture_sysclk);

	// calculate capture banding filter
	light_frequency = OV5640_get_light_frequency();
	if (light_frequency == 60) {
		// 60Hz
		capture_bandingfilter = capture_sysclk * 100 / capture_HTS * 100 / 120;
	} else {
		// 50Hz
		capture_bandingfilter = capture_sysclk * 100 / capture_HTS;
	}
	capture_max_band = (int)((capture_VTS - 4)/capture_bandingfilter);

	SENSOR_PRINT("light_frequency %d, capture_bandingfilter %d, capture_max_band %d",
		light_frequency,
		capture_bandingfilter,
		capture_max_band);
	// calculate capture shutter/gain16
	if (average > (int)ae_low && average < (int)ae_high) {
		// in stable range
		capture_gain16_shutter = preview_gain16 * preview_shutter * capture_sysclk/preview_sysclk * preview_hts / capture_HTS * ae_target / average;
	} else {
		capture_gain16_shutter = preview_gain16 * preview_shutter * capture_sysclk/preview_sysclk * preview_hts / capture_HTS;
	}
	SENSOR_PRINT("capture_gain16_shutter %d", (int)capture_gain16_shutter);
	// gain to shutter
	if (capture_gain16_shutter < (capture_bandingfilter * 16)) {
		// shutter < 1/100
		capture_shutter = capture_gain16_shutter/16;
		if(capture_shutter <1)
			capture_shutter = 1;

		capture_gain16 = capture_gain16_shutter/capture_shutter;
		if(capture_gain16 < 16)
			capture_gain16 = 16;
	} else {
		if(capture_gain16_shutter > (capture_bandingfilter*capture_max_band*16)) {
			// exposure reach max
			capture_shutter = capture_bandingfilter*capture_max_band;
			capture_gain16 = capture_gain16_shutter / capture_shutter;
		} else {
			// 1/100 < capture_shutter =< max, capture_shutter = n/100
			capture_shutter = ((int)(capture_gain16_shutter/16/capture_bandingfilter)) * capture_bandingfilter;
			capture_gain16 = capture_gain16_shutter / capture_shutter;
		}
	}

	SENSOR_PRINT("capture_shutter %d, capture_gain16 %d",
		capture_shutter,
		capture_gain16);

	// write capture gain
	OV5640_set_gain16(capture_gain16);

	// write capture shutter
	if (capture_shutter > (capture_VTS - 4)) {
		capture_VTS = capture_shutter + 4;
		OV5640_set_VTS_ori(capture_VTS);
	}
	OV5640_set_shutter(capture_shutter);
	s_capture_shutter = capture_shutter;
	s_capture_VTS = capture_VTS;
	_ov5640_ReadGain(param);
	Sensor_SetSensorExifInfo(SENSOR_EXIF_CTRL_EXPOSURETIME,
				 (uint32_t) capture_shutter);
	if(iso_mode == 0){
		uint32_t iso_value = (uint32_t)Sensor_ReadReg(0x350b);
		Sensor_SetSensorExifInfo(SENSOR_EXIF_CTRL_ISOSPEEDRATINGS, (uint32_t)iso_value);
	}
	return 0;
}

LOCAL uint32_t _ov5640_BeforeSnapshot(uint32_t param)
{
	uint32_t cap_mode = (param>>CAP_MODE_BITS);

	param = param&0xffff;
	SENSOR_PRINT("%d,%d.",cap_mode,param);
	if (SENSOR_MODE_PREVIEW_ONE >= param) {
		s_capture_shutter = OV5640_get_shutter();
		s_capture_VTS = OV5640_get_VTS();
		_ov5640_ReadGain(param);
		return SENSOR_SUCCESS;
	}
	OV5640_capture(param);
	SENSOR_Sleep(10);//Bug 279043, to skip unstable signal output from sensor
	SENSOR_PRINT("Sleep out");

	return SENSOR_SUCCESS;
}

LOCAL uint32_t _ov5640_check_image_format_support(uint32_t param)
{
	uint32_t ret_val = SENSOR_FAIL;

	switch (param) {
	case SENSOR_IMAGE_FORMAT_YUV422:
		ret_val = SENSOR_SUCCESS;
		break;
	case SENSOR_IMAGE_FORMAT_JPEG:
		ret_val = SENSOR_SUCCESS;
		break;
	default:
		break;
	}
	return ret_val;
}

LOCAL uint32_t _ov5640_pick_out_jpeg_stream(uint32_t param)
{
#if 0
	uint8_t *p_frame =
	    ((DCAMERA_SNAPSHOT_RETURN_PARAM_T *) param)->return_data_addr;
	uint32_t buf_len =
	    ((DCAMERA_SNAPSHOT_RETURN_PARAM_T *) param)->return_data_len;
	uint32_t i = 0x00;

	SENSOR_PRINT("SENSOR: ov5640 jpeg capture head: 0x%x, 0x%x \n",
		     *((uint8 *) p_frame), *((uint8 *) p_frame + 1));

	/* Find the tail position */
	for (i = 0x00; i < buf_len; i++) {
#define TAIL_VAL 0xffd9
		uint8_t *p_cur_val = (uint8 *) p_frame;

		uint16_t tail_val = ((p_cur_val[i] << 8) | p_cur_val[i + 1]);

		if (TAIL_VAL == tail_val) {
			i += 2;
			break;
		}
	}

	/* check if the tail is found */
	if (i < buf_len) {
		SENSOR_PRINT
		    ("SENSOR: ov5640 Found the jpeg tail at %d: 0x%x 0x%x \n",
		     i + 1, *((uint8 *) p_frame + i),
		     *((uint8 *) p_frame + i + 1));
	} else {
		SENSOR_PRINT("SENSOR: ov5640 can not find the jpeg tail: %d \n",
			     i);
		i = 0x00;
	}

	return i;
#endif
	return 0;
}

#if 0
LOCAL uint32_t _ov5640_chang_image_format(uint32_t param)
{
	SENSOR_REG_TAB_INFO_T st_yuv422_reg_table_info =
	    { ADDR_AND_LEN_OF_ARRAY(ov5640_640X480), 0, 0, 0, 0 };
	uint32_t ret_val = SENSOR_FAIL;

	switch (param) {
	case SENSOR_IMAGE_FORMAT_YUV422:
		SENSOR_PRINT("SENSOR: ov5640  chang_image_format  YUV422 \n");
		ret_val = Sensor_SendRegTabToSensor(&st_yuv422_reg_table_info);
		break;

	case SENSOR_IMAGE_FORMAT_JPEG:
		SENSOR_PRINT("SENSOR: ov5640  chang_image_format  jpg \n");
		ret_val = SENSOR_FAIL;	//Sensor_SendRegTabToSensor(&st_jpeg_reg_table_info);
		break;

	default:
		break;
	}

	return ret_val;
}
#endif

LOCAL uint32_t _ov5640_after_snapshot(uint32_t param)
{
	Sensor_SetMode(param);
	return SENSOR_SUCCESS;
}

LOCAL uint32_t _ov5640_MatchZone(SENSOR_EXT_FUN_T_PTR param_ptr)
{
	SENSOR_RECT_T zone_rect;
	uint32_t rtn = SENSOR_SUCCESS;

	memset((void*)&zone_rect, 0, sizeof(SENSOR_RECT_T));
	switch (param_ptr->cmd) {
	case SENSOR_EXT_FOCUS_START:
		switch (param_ptr->param) {
		case SENSOR_EXT_FOCUS_ZONE:
		case SENSOR_EXT_FOCUS_MULTI_ZONE:
			zone_rect.w = FOCUS_ZONE_W;
			zone_rect.h = FOCUS_ZONE_H;
			break;
		default:
			break;
		}
		break;
	case SENSOR_EXT_EXPOSURE_START:
		switch (param_ptr->param) {
		case SENSOR_EXT_EXPOSURE_ZONE:
			zone_rect.w = EXPOSURE_ZONE_W;
			zone_rect.h = EXPOSURE_ZONE_H;
			break;
		default:
			break;
		}
		break;
	default:
		break;
	}

	if ((0x00 != g_ov5640_yuv_info.resolution_tab_info_ptr[SENSOR_MODE_PREVIEW_ONE].width)
	    && (0x00 !=
		g_ov5640_yuv_info.resolution_tab_info_ptr[SENSOR_MODE_PREVIEW_ONE].height)
	    && (0x00 != zone_rect.w)
	    && (0x00 != zone_rect.h)) {
		param_ptr->zone.x =
		    (zone_rect.w * param_ptr->zone.x) /
		    g_ov5640_yuv_info.resolution_tab_info_ptr[SENSOR_MODE_PREVIEW_ONE].width;
		param_ptr->zone.y =
		    (zone_rect.h * param_ptr->zone.y) /
		    g_ov5640_yuv_info.resolution_tab_info_ptr[SENSOR_MODE_PREVIEW_ONE].height;
	} else {
		SENSOR_PRINT("w:%d, h:%d error",
			     zone_rect.w, zone_rect.h);
		rtn = SENSOR_FAIL;
	}

	SENSOR_PRINT("x:%d, y:%d",
		     param_ptr->zone.x, param_ptr->zone.y);
	return rtn;
}

LOCAL uint32_t _ov5640_AutoFocusTrig(SENSOR_EXT_FUN_PARAM_T_PTR param_ptr)
{
	uint32_t rtn = SENSOR_SUCCESS;
	uint16_t i = AUTOFOCUS_TIMEOUT;
	uint16_t reg_value = 0x00;
	af_quit_flag = 0;

	SENSOR_PRINT("Start");

	Sensor_WriteReg(CMD_ACK, 0x01);
	Sensor_WriteReg(CMD_MAIN, 0x03);

	do {
		if (0x00 == i) {
			SENSOR_PRINT_ERR("error!");
			rtn = SENSOR_FAIL;
			break;
		} else if (af_quit_flag) {
			SENSOR_PRINT("_ov5640_AutoFocusTrig af will quit!");
			af_quit_flag = 0;
			break;
		}
		usleep(10*1000);
		reg_value = Sensor_ReadReg(CMD_ACK);
		i--;
	} while (0x00 != reg_value);

	if (SENSOR_SUCCESS == rtn) {
		reg_value = Sensor_ReadReg(CMD_PARAM4);
		if (0x00 == reg_value) {
			SENSOR_PRINT_ERR("fail!");
			rtn = SENSOR_FAIL;
			_ov5640_init_firmware();
		}
	}
	return rtn;
}

LOCAL uint32_t _ov5640_AutoFocusZone(SENSOR_EXT_FUN_PARAM_T_PTR param_ptr)
{
	uint32_t i = AUTOFOCUS_TIMEOUT;	// 2.8 seconds
	uint16_t reg_value = 0x00;
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_T ext_param;

	SENSOR_PRINT("%d, %d", param_ptr->zone[0].x, param_ptr->zone[0].y);
	SENSOR_PRINT("0x3001=0x%x,0x3005=0x%x.",
		Sensor_ReadReg(0x3001),Sensor_ReadReg(0x3005));
	SENSOR_PRINT("0x3000=0x%x,0x3004=0x%x,0x3f00=0x%x.",
		Sensor_ReadReg(0x3000),Sensor_ReadReg(0x3004),Sensor_ReadReg(0x3f00));

	ext_param.cmd = param_ptr->cmd;
	ext_param.param = param_ptr->param;
	ext_param.zone.x = param_ptr->zone[0].x;
	ext_param.zone.y = param_ptr->zone[0].y;
	ext_param.zone.w = param_ptr->zone[0].w;
	ext_param.zone.h = param_ptr->zone[0].h;

	rtn = _ov5640_MatchZone(&ext_param);

	if (SENSOR_SUCCESS == rtn) {
		Sensor_WriteReg(CMD_PARAM0, ext_param.zone.x);
		Sensor_WriteReg(CMD_PARAM1, ext_param.zone.y);
		Sensor_WriteReg(CMD_PARAM2, FOCUS_ZONE_W);
		Sensor_WriteReg(CMD_PARAM3, FOCUS_ZONE_H);

		Sensor_WriteReg(CMD_ACK, 0x01);
		Sensor_WriteReg(CMD_MAIN, 0x81);

		usleep(10*1000);

		Sensor_WriteReg(CMD_ACK, 0x01);
		Sensor_WriteReg(CMD_MAIN, 0x03);

		do {
			if (0x00 == i) {
				SENSOR_PRINT_ERR("error!");
				rtn = SENSOR_FAIL;
				break;
			} else if (af_quit_flag) {
				SENSOR_PRINT("af will be quit!");
				af_quit_flag = 0;
				break;
			}
			usleep(10*1000);
			reg_value = Sensor_ReadReg(CMD_ACK);
			SENSOR_PRINT("cycles %d, reg %d", i, reg_value);
			i--;
		} while (0x00 != reg_value);

		if(SENSOR_SUCCESS == rtn) {
			reg_value=Sensor_ReadReg(CMD_PARAM4);
			if (0 == reg_value) {
				SENSOR_PRINT_ERR("fail!");
				rtn=SENSOR_FAIL;
				_ov5640_init_firmware();
			}
		}

		/* 0x3029: 0x00 - auto focusing, 0x10 - success, 0x7f - failed */
		/*reg_value = Sensor_ReadReg(0x3029);
		SENSOR_PRINT_ERR("0x3029 = %x", reg_value);*/
	}
	if (SENSOR_SUCCESS == rtn)
		SENSOR_PRINT_HIGH("success!");
	return rtn;
}

LOCAL uint32_t _ov5640_AutoFocusMultiZone(SENSOR_EXT_FUN_PARAM_T_PTR param_ptr)
{
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_T ext_param[5];
	uint32_t i = 100;
	uint16_t reg_value = 0x00;
	uint32_t zone_cnt = 0;
	uint32_t zone_num = 0x90;

	SENSOR_PRINT("Start");
	zone_cnt = (param_ptr->zone_cnt > 5) ? 5 : param_ptr->zone_cnt;
	for (i = 0; i < zone_cnt; i++) {
		ext_param[i].cmd = param_ptr->cmd;
		ext_param[i].param = param_ptr->param;
		ext_param[i].zone.x = param_ptr->zone[i].x;
		ext_param[i].zone.y = param_ptr->zone[i].y;
		ext_param[i].zone.w = param_ptr->zone[i].w;
		ext_param[i].zone.h = param_ptr->zone[i].h;
		SENSOR_PRINT("x=%d,y=%d",
		       ext_param[i].zone.x, ext_param[i].zone.y);
		rtn = _ov5640_MatchZone(&ext_param[i]);
		if (SENSOR_SUCCESS != rtn) {
			SENSOR_PRINT_ERR
			    ("match zone error!");
			return SENSOR_FAIL;
		}
		SENSOR_PRINT("x=%d,y=%d",
		       ext_param[i].zone.x, ext_param[i].zone.y);
	}

	for (i = 0; i < zone_cnt; i++) {
		Sensor_WriteReg(CMD_PARAM0, ext_param[i].zone.x);
		Sensor_WriteReg(CMD_PARAM1, ext_param[i].zone.y);
		Sensor_WriteReg(CMD_PARAM2, FOCUS_ZONE_W);
		Sensor_WriteReg(CMD_PARAM3, FOCUS_ZONE_H);

		Sensor_WriteReg(CMD_ACK, 0x01);
		Sensor_WriteReg(CMD_MAIN, zone_num);
		zone_num++;
	}

	i = AUTOFOCUS_TIMEOUT;
	usleep(10*1000);
	Sensor_WriteReg(CMD_ACK, 0x01);
	Sensor_WriteReg(CMD_MAIN, 0x03);

	do {
		if (0x00 == i) {
			SENSOR_PRINT_ERR("error!");
			rtn = SENSOR_FAIL;
			break;
		} else if (af_quit_flag) {
			SENSOR_PRINT_HIGH("quit!");
			af_quit_flag = 0;
			break;
		}
		usleep(10*1000);
		reg_value = Sensor_ReadReg(CMD_ACK);
		i--;
	} while (0x00 != reg_value);

	if(SENSOR_SUCCESS==rtn)
	{
		reg_value=Sensor_ReadReg(CMD_PARAM4);
		if(0x00==reg_value)
		{
			SENSOR_PRINT_ERR("fail!");
			rtn=SENSOR_FAIL;
			_ov5640_init_firmware();
		}
	}
	return rtn;
}

LOCAL uint32_t _ov5640_AutoFocusMacro(SENSOR_EXT_FUN_PARAM_T_PTR param_ptr)
{
	uint32_t rtn = SENSOR_SUCCESS;
	uint16_t i=30;
	uint16_t reg_value = 0x00;

	SENSOR_PRINT("In");

	Sensor_WriteReg(0x3603,0x3f);

	SENSOR_PRINT("Done! rtn = %d", rtn);
	return rtn;
}

LOCAL uint32_t _ov5640_CheckAFGain(SENSOR_EXT_FUN_PARAM_T_PTR param_ptr)
{
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_PARAM_T_PTR ext_ptr = (SENSOR_EXT_FUN_PARAM_T_PTR) param_ptr;
	uint32_t cur_af_gain = 0;
	uint32_t delta_gain = 0;

	cur_af_gain = _ov5640_get_cur_af_gain();
	delta_gain = ABS((int32_t)cur_af_gain - (int32_t)s_af_gain);
	SENSOR_PRINT("delta_gain %d, s_is_dv_mode %d", delta_gain, s_is_dv_mode);
	if ((delta_gain > FOCUS_MOVE_GAIN_CHECK)
		&& (0 != s_af_gain)
		&& (0 == s_is_dv_mode)) {
		ext_ptr->zone_cnt = 1;
	}

	s_af_gain = cur_af_gain;

	return rtn;
}

LOCAL uint32_t _ov5640_StartAutoFocus(uint32_t param)
{
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_PARAM_T_PTR ext_ptr = (SENSOR_EXT_FUN_PARAM_T_PTR) param;
	SENSOR_PRINT("SENSOR: _ov5640_StartAutoFocus param =%d", ext_ptr->param);

	switch (ext_ptr->param) {
	case SENSOR_EXT_FOCUS_TRIG:
	case SENSOR_EXT_FOCUS_CAF:
		rtn = _ov5640_AutoFocusTrig(ext_ptr);
		break;
	case SENSOR_EXT_FOCUS_ZONE:
		rtn = _ov5640_AutoFocusZone(ext_ptr);
		break;
	case SENSOR_EXT_FOCUS_MULTI_ZONE:
		rtn = _ov5640_AutoFocusMultiZone(ext_ptr);
		break;
	case SENSOR_EXT_FOCUS_MACRO:
		rtn = _ov5640_AutoFocusTrig(ext_ptr);//rtn = _ov5640_AutoFocusMacro(ext_ptr);
		break;
	case SENSOR_EXT_FOCUS_CHECK_AF_GAIN:
		rtn = _ov5640_CheckAFGain(ext_ptr);
		break;
	default:
		break;
	}
	return rtn;
}

LOCAL uint32_t _ov5640_QuitAutoFocus(void)
{
	uint32_t ret = SENSOR_SUCCESS;
	af_quit_flag = 0x1;
	SENSOR_PRINT("af quit flag setted!");
	return ret;
}


LOCAL uint32_t _ov5640_ExposureAuto(void)
{
	uint32_t rtn = SENSOR_SUCCESS;

	SENSOR_PRINT("SENSOR: _ov5640_ExposureAuto");
	Sensor_WriteReg(0x501d, 0x00);
	return rtn;
}

LOCAL uint32_t _ov5640_ExposureZone(SENSOR_EXT_FUN_T_PTR param_ptr)
{
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_T_PTR ext_ptr = (SENSOR_EXT_FUN_T_PTR) param_ptr;
	uint16_t reg_value = 0x00;

	SENSOR_PRINT("%d, %d", ext_ptr->zone.x, ext_ptr->zone.y);

	rtn = _ov5640_MatchZone(ext_ptr);

	if (SENSOR_SUCCESS == rtn) {
		// h zone
		if (0x00 < (ext_ptr->zone.x - (EXPOSURE_ZONE_W / 0x08))) {
			ext_ptr->zone.x -= (EXPOSURE_ZONE_W / 0x08);
		} else {
			ext_ptr->zone.x = 0x00;
		}
		ext_ptr->zone.w = EXPOSURE_ZONE_W / 0x04;
		if (EXPOSURE_ZONE_W < (ext_ptr->zone.x + ext_ptr->zone.w)) {
			ext_ptr->zone.x =
			    EXPOSURE_ZONE_W - (EXPOSURE_ZONE_W / 0x04);
		}
		// v zone
		if (0x00 < (ext_ptr->zone.y - (EXPOSURE_ZONE_H / 0x08))) {
			ext_ptr->zone.y -= (EXPOSURE_ZONE_H / 0x08);
		} else {
			ext_ptr->zone.y = 0x00;
		}
		ext_ptr->zone.h = EXPOSURE_ZONE_H / 0x04;
		if (EXPOSURE_ZONE_H < (ext_ptr->zone.y + ext_ptr->zone.h)) {
			ext_ptr->zone.y =
			    EXPOSURE_ZONE_H - (EXPOSURE_ZONE_H / 0x04);
		}

		SENSOR_PRINT("%d, %d, %d, %d",
			     ext_ptr->zone.x,
			     ext_ptr->zone.y,
			     ext_ptr->zone.w,
			     ext_ptr->zone.h);

		reg_value = ((ext_ptr->zone.x >> 0x08) & 0x07);
		Sensor_WriteReg(0x5680, reg_value);
		reg_value = (ext_ptr->zone.x & 0xff);
		Sensor_WriteReg(0x5681, reg_value);

		reg_value = ((ext_ptr->zone.y >> 0x08) & 0x07);
		Sensor_WriteReg(0x5682, reg_value);
		reg_value = (ext_ptr->zone.y & 0xff);
		Sensor_WriteReg(0x5683, reg_value);

		reg_value = ((ext_ptr->zone.w >> 0x08) & 0x0f);
		Sensor_WriteReg(0x5684, reg_value);
		reg_value = (ext_ptr->zone.w & 0xff);
		Sensor_WriteReg(0x5685, reg_value);

		reg_value = ((ext_ptr->zone.h >> 0x08) & 0x0f);
		Sensor_WriteReg(0x5686, reg_value);
		reg_value = (ext_ptr->zone.h & 0xff);
		Sensor_WriteReg(0x5687, reg_value);
		Sensor_WriteReg(0x501d, 0x10);
	}

	return rtn;
}

LOCAL uint32_t _ov5640_StartExposure(uint32_t param)
{
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_T_PTR ext_ptr = (SENSOR_EXT_FUN_T_PTR) param;

	SENSOR_PRINT("SENSOR: _ov5640_StartExposure param =%d",
		     ext_ptr->param);

	switch (ext_ptr->param) {
	case SENSOR_EXT_EXPOSURE_AUTO:
		rtn = _ov5640_ExposureAuto();
		break;
	case SENSOR_EXT_EXPOSURE_ZONE:
		rtn = _ov5640_ExposureZone(ext_ptr);
		break;
	default:
		break;
	}
	return rtn;
}

LOCAL uint32_t _ov5640_ReadGain(uint32_t param)
{
	uint32_t rtn = SENSOR_SUCCESS;
	uint16_t value=0x00;
	uint32_t gain = 0;

	value = Sensor_ReadReg(0x350b);/*0-7*/
	gain = value&0xff;
	value = Sensor_ReadReg(0x350a);/*8*/
	gain |= (value<<0x08)&0x300;

	s_ov5640_gain=(int)gain;

	SENSOR_PRINT("SENSOR: _ov5640_ReadGain gain: 0x%x", s_ov5640_gain);

	return rtn;
}

LOCAL void _calculate_hdr_exposure(int capture_gain16,int capture_VTS, int capture_shutter)
{
	SENSOR_PRINT("in param capture_gain16 0x%x, capture_VTS 0x%x capture_shutter 0x%x",
				capture_gain16,
				capture_VTS,
				capture_shutter);
	// write capture gain
	OV5640_set_gain16(capture_gain16);

	// write capture shutter
	if (capture_shutter > (capture_VTS - 4)) {
		capture_VTS = capture_shutter + 4;
		SENSOR_PRINT("actual capture_VTS 0x%x", capture_VTS);
		OV5640_set_VTS_ori(capture_VTS);
	}
	OV5640_set_shutter(capture_shutter);
}

LOCAL uint32_t _ov5640_SetEV(uint32_t param)
{
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_PARAM_T_PTR ext_ptr = (SENSOR_EXT_FUN_PARAM_T_PTR) param;

	uint16_t value=0x00;
	uint32_t gain = s_ov5640_gain;
	uint32_t ev = ext_ptr->param;

	SENSOR_PRINT("SENSOR: _ov5640_SetEV param: 0x%x", ext_ptr->param);
#if 0
	gain=(gain*ext_ptr->param)>>0x06;

	value = gain&0xff;
	Sensor_WriteReg(0x350b, value);/*0-7*/
	value = (gain>>0x08)&0x03;
	Sensor_WriteReg(0x350a, value);/*8*/
#endif
	switch(ev) {
	case SENSOR_HDR_EV_LEVE_0:
		_calculate_hdr_exposure(s_ov5640_gain/4,s_capture_VTS,s_capture_shutter/2);
		break;
	case SENSOR_HDR_EV_LEVE_1:
		_calculate_hdr_exposure(s_ov5640_gain,s_capture_VTS,s_capture_shutter);
		break;
	case SENSOR_HDR_EV_LEVE_2:
		_calculate_hdr_exposure(s_ov5640_gain*3/2,s_capture_VTS,s_capture_shutter);
		break;
	default:
		break;
	}
	return rtn;
}

LOCAL uint32_t _ov5640_saveLoad_exposure(uint32_t param)
{
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_PARAM_T_PTR sl_ptr = (SENSOR_EXT_FUN_PARAM_T_PTR)param;

	uint32_t sl_param = sl_ptr->param;
	if (sl_param) {
		usleep(180*1000);     /*wait for effect after init stable(AWB)*/
		/*load exposure params to sensor*/
		SENSOR_PRINT_HIGH("_ov5640_saveLoad_exposure load shutter 0x%x gain 0x%x",
					s_ov5640_shutter_bak,
					s_ov5640_gain_bak);
		OV5640_set_gain16(s_ov5640_gain_bak);
		OV5640_set_shutter(s_ov5640_shutter_bak);
	} else {
		/*ave exposure params from sensor*/
		s_ov5640_shutter_bak = OV5640_get_shutter();
		s_ov5640_gain_bak = OV5640_get_gain16();
		SENSOR_PRINT_HIGH("_ov5640_saveLoad_exposure save shutter 0x%x gain 0x%x",
					s_ov5640_shutter_bak,
					s_ov5640_gain_bak);
	}
	return rtn;
}

LOCAL uint8_t af_firmware[] = {
		0x80,
		0x00,
		0x02,
		0x0f,
		0xe0,
		0x02,
		0x09,
		0x28,
		0xc2,
		0x01,
		0x22,
		0x22,
		0x00,
		0x02,
		0x0d,
		0xea,
		0x30,
		0x01,
		0x03,
		0x02,
		0x02,
		0xa6,
		0x30,
		0x02,
		0x03,
		0x02,
		0x02,
		0xa6,
		0x90,
		0x51,
		0xa5,
		0xe0,
		0x78,
		0x93,
		0xf6,
		0xa3,
		0xe0,
		0x08,
		0xf6,
		0xa3,
		0xe0,
		0x08,
		0xf6,
		0xe5,
		0x1f,
		0x70,
		0x4f,
		0x75,
		0x1e,
		0x20,
		0xd2,
		0x35,
		0xd3,
		0x78,
		0x4f,
		0xe6,
		0x94,
		0x00,
		0x18,
		0xe6,
		0x94,
		0x00,
		0x40,
		0x07,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0x80,
		0x03,
		0x12,
		0x0c,
		0x67,
		0x78,
		0x7e,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0x78,
		0x8b,
		0xa6,
		0x09,
		0x18,
		0x76,
		0x01,
		0x12,
		0x0c,
		0x67,
		0x78,
		0x4e,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0x78,
		0x8b,
		0xe6,
		0x78,
		0x6e,
		0xf6,
		0x75,
		0x1f,
		0x01,
		0x78,
		0x93,
		0xe6,
		0x78,
		0x90,
		0xf6,
		0x78,
		0x94,
		0xe6,
		0x78,
		0x91,
		0xf6,
		0x78,
		0x95,
		0xe6,
		0x78,
		0x92,
		0xf6,
		0x22,
		0x79,
		0x90,
		0xe7,
		0xd3,
		0x78,
		0x93,
		0x96,
		0x40,
		0x05,
		0xe7,
		0x96,
		0xff,
		0x80,
		0x08,
		0xc3,
		0x79,
		0x93,
		0xe7,
		0x78,
		0x90,
		0x96,
		0xff,
		0x78,
		0x88,
		0x76,
		0x00,
		0x08,
		0xa6,
		0x07,
		0x79,
		0x91,
		0xe7,
		0xd3,
		0x78,
		0x94,
		0x96,
		0x40,
		0x05,
		0xe7,
		0x96,
		0xff,
		0x80,
		0x08,
		0xc3,
		0x79,
		0x94,
		0xe7,
		0x78,
		0x91,
		0x96,
		0xff,
		0x12,
		0x0c,
		0xb0,
		0x79,
		0x92,
		0xe7,
		0xd3,
		0x78,
		0x95,
		0x96,
		0x40,
		0x05,
		0xe7,
		0x96,
		0xff,
		0x80,
		0x08,
		0xc3,
		0x79,
		0x95,
		0xe7,
		0x78,
		0x92,
		0x96,
		0xff,
		0x12,
		0x0c,
		0xb0,
		0x12,
		0x0c,
		0x67,
		0x78,
		0x8a,
		0xe6,
		0x25,
		0xe0,
		0x24,
		0x4e,
		0xf8,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0x78,
		0x8a,
		0xe6,
		0x24,
		0x6e,
		0xf8,
		0xa6,
		0x09,
		0x90,
		0x0e,
		0x93,
		0xe4,
		0x93,
		0x24,
		0xff,
		0xff,
		0xe4,
		0x34,
		0xff,
		0xfe,
		0x78,
		0x8a,
		0xe6,
		0x24,
		0x01,
		0xfd,
		0xe4,
		0x33,
		0xfc,
		0xd3,
		0xed,
		0x9f,
		0xee,
		0x64,
		0x80,
		0xf8,
		0xec,
		0x64,
		0x80,
		0x98,
		0x40,
		0x04,
		0x7f,
		0x00,
		0x80,
		0x05,
		0x78,
		0x8a,
		0xe6,
		0x04,
		0xff,
		0x78,
		0x8a,
		0xa6,
		0x07,
		0xe5,
		0x1f,
		0xb4,
		0x01,
		0x0a,
		0xe6,
		0x60,
		0x03,
		0x02,
		0x02,
		0xa6,
		0x75,
		0x1f,
		0x02,
		0x22,
		0x78,
		0x4e,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0x78,
		0x80,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0x78,
		0x4e,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0x78,
		0x82,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0x78,
		0x6e,
		0xe6,
		0x78,
		0x8c,
		0xf6,
		0x78,
		0x6e,
		0xe6,
		0x78,
		0x8d,
		0xf6,
		0x7f,
		0x01,
		0x90,
		0x0e,
		0x93,
		0xe4,
		0x93,
		0xfe,
		0xef,
		0xc3,
		0x9e,
		0x50,
		0x5f,
		0xef,
		0x25,
		0xe0,
		0x24,
		0x4f,
		0xf9,
		0xc3,
		0x78,
		0x81,
		0xe6,
		0x97,
		0x18,
		0xe6,
		0x19,
		0x97,
		0x50,
		0x0a,
		0x12,
		0x0c,
		0x98,
		0x78,
		0x80,
		0xa6,
		0x04,
		0x08,
		0xa6,
		0x05,
		0x74,
		0x6e,
		0x2f,
		0xf9,
		0x78,
		0x8c,
		0xe6,
		0xc3,
		0x97,
		0x50,
		0x08,
		0x74,
		0x6e,
		0x2f,
		0xf8,
		0xe6,
		0x78,
		0x8c,
		0xf6,
		0xef,
		0x25,
		0xe0,
		0x24,
		0x4f,
		0xf9,
		0xd3,
		0x78,
		0x83,
		0xe6,
		0x97,
		0x18,
		0xe6,
		0x19,
		0x97,
		0x40,
		0x0a,
		0x12,
		0x0c,
		0x98,
		0x78,
		0x82,
		0xa6,
		0x04,
		0x08,
		0xa6,
		0x05,
		0x74,
		0x6e,
		0x2f,
		0xf9,
		0x78,
		0x8d,
		0xe6,
		0xd3,
		0x97,
		0x40,
		0x08,
		0x74,
		0x6e,
		0x2f,
		0xf8,
		0xe6,
		0x78,
		0x8d,
		0xf6,
		0x0f,
		0x80,
		0x96,
		0xc3,
		0x79,
		0x81,
		0xe7,
		0x78,
		0x83,
		0x96,
		0xff,
		0x19,
		0xe7,
		0x18,
		0x96,
		0x78,
		0x84,
		0xf6,
		0x08,
		0xa6,
		0x07,
		0xc3,
		0x79,
		0x8c,
		0xe7,
		0x78,
		0x8d,
		0x96,
		0x08,
		0xf6,
		0x12,
		0x0c,
		0xa4,
		0x40,
		0x05,
		0x09,
		0xe7,
		0x08,
		0x80,
		0x06,
		0xc3,
		0x79,
		0x7f,
		0xe7,
		0x78,
		0x81,
		0x96,
		0xff,
		0x19,
		0xe7,
		0x18,
		0x96,
		0xfe,
		0x78,
		0x86,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0x79,
		0x8c,
		0xe7,
		0xd3,
		0x78,
		0x8b,
		0x96,
		0x40,
		0x05,
		0xe7,
		0x96,
		0xff,
		0x80,
		0x08,
		0xc3,
		0x79,
		0x8b,
		0xe7,
		0x78,
		0x8c,
		0x96,
		0xff,
		0x78,
		0x8f,
		0xa6,
		0x07,
		0xe5,
		0x1f,
		0x64,
		0x02,
		0x60,
		0x03,
		0x02,
		0x02,
		0x92,
		0x90,
		0x0e,
		0x91,
		0x93,
		0xff,
		0x18,
		0xe6,
		0xc3,
		0x9f,
		0x40,
		0x03,
		0x02,
		0x02,
		0xa6,
		0x78,
		0x84,
		0x12,
		0x0c,
		0x89,
		0x12,
		0x0c,
		0x5e,
		0x90,
		0x0e,
		0x8e,
		0x12,
		0x0c,
		0x77,
		0x78,
		0x80,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0x12,
		0x0c,
		0xba,
		0x7b,
		0x04,
		0x12,
		0x0c,
		0x4c,
		0xc3,
		0x12,
		0x06,
		0xa6,
		0x50,
		0x64,
		0x90,
		0x0e,
		0x92,
		0xe4,
		0x93,
		0xff,
		0x78,
		0x8f,
		0xe6,
		0x9f,
		0x40,
		0x02,
		0x80,
		0x11,
		0x90,
		0x0e,
		0x90,
		0xe4,
		0x93,
		0xff,
		0xd3,
		0x78,
		0x89,
		0xe6,
		0x9f,
		0x18,
		0xe6,
		0x94,
		0x00,
		0x40,
		0x03,
		0x75,
		0x1f,
		0x05,
		0x78,
		0x86,
		0x12,
		0x0c,
		0x89,
		0x12,
		0x0c,
		0x5e,
		0x90,
		0x0e,
		0x8f,
		0x12,
		0x0c,
		0x77,
		0x12,
		0x0c,
		0xa4,
		0x40,
		0x02,
		0x80,
		0x02,
		0x78,
		0x80,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0x12,
		0x0c,
		0xba,
		0x7b,
		0x10,
		0x12,
		0x0c,
		0x4c,
		0xd3,
		0x12,
		0x06,
		0xa6,
		0x40,
		0x18,
		0x75,
		0x1f,
		0x05,
		0x22,
		0xe5,
		0x1f,
		0xb4,
		0x05,
		0x0f,
		0xd2,
		0x01,
		0xc2,
		0x02,
		0xe4,
		0xf5,
		0x1f,
		0xf5,
		0x1e,
		0xd2,
		0x35,
		0xd2,
		0x33,
		0xd2,
		0x36,
		0x22,
		0xe5,
		0x1f,
		0x70,
		0x72,
		0xf5,
		0x1e,
		0xd2,
		0x35,
		0xff,
		0xef,
		0x25,
		0xe0,
		0x24,
		0x4e,
		0xf8,
		0xe4,
		0xf6,
		0x08,
		0xf6,
		0x0f,
		0xbf,
		0x34,
		0xf2,
		0x90,
		0x0e,
		0x94,
		0xe4,
		0x93,
		0xff,
		0xe5,
		0x4b,
		0xc3,
		0x9f,
		0x50,
		0x04,
		0x7f,
		0x05,
		0x80,
		0x02,
		0x7f,
		0xfb,
		0x78,
		0xbd,
		0xa6,
		0x07,
		0x12,
		0x0e,
		0xb1,
		0x40,
		0x04,
		0x7f,
		0x03,
		0x80,
		0x02,
		0x7f,
		0x30,
		0x78,
		0xbc,
		0xa6,
		0x07,
		0xe6,
		0x18,
		0xf6,
		0x08,
		0xe6,
		0x78,
		0xb9,
		0xf6,
		0x78,
		0xbc,
		0xe6,
		0x78,
		0xba,
		0xf6,
		0x78,
		0xbf,
		0x76,
		0x33,
		0xe4,
		0x08,
		0xf6,
		0x78,
		0xb8,
		0x76,
		0x01,
		0x75,
		0x4a,
		0x02,
		0x78,
		0xb6,
		0xf6,
		0x08,
		0xf6,
		0x74,
		0xff,
		0x78,
		0xc1,
		0xf6,
		0x08,
		0xf6,
		0x75,
		0x1f,
		0x01,
		0x78,
		0xbc,
		0xe6,
		0x75,
		0xf0,
		0x05,
		0xa4,
		0xf5,
		0x4b,
		0x12,
		0x0b,
		0x39,
		0xc2,
		0x37,
		0x22,
		0x78,
		0xb8,
		0xe6,
		0xd3,
		0x94,
		0x00,
		0x40,
		0x02,
		0x16,
		0x22,
		0xe5,
		0x1f,
		0xb4,
		0x05,
		0x23,
		0xe4,
		0xf5,
		0x1f,
		0xc2,
		0x01,
		0x78,
		0xb6,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0x78,
		0x4e,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0xa2,
		0x37,
		0xe4,
		0x33,
		0xf5,
		0x3c,
		0x90,
		0x30,
		0x28,
		0xf0,
		0x75,
		0x1e,
		0x10,
		0xd2,
		0x35,
		0x22,
		0xe5,
		0x4b,
		0x75,
		0xf0,
		0x05,
		0x84,
		0x78,
		0xbc,
		0xf6,
		0x90,
		0x0e,
		0x8c,
		0xe4,
		0x93,
		0xff,
		0x25,
		0xe0,
		0x24,
		0x0a,
		0xf8,
		0xe6,
		0xfc,
		0x08,
		0xe6,
		0xfd,
		0x78,
		0xbc,
		0xe6,
		0x25,
		0xe0,
		0x24,
		0x4e,
		0xf8,
		0xa6,
		0x04,
		0x08,
		0xa6,
		0x05,
		0xef,
		0x12,
		0x0e,
		0xf5,
		0xd3,
		0x78,
		0xb7,
		0x96,
		0xee,
		0x18,
		0x96,
		0x40,
		0x0d,
		0x78,
		0xbc,
		0xe6,
		0x78,
		0xb9,
		0xf6,
		0x78,
		0xb6,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0x90,
		0x0e,
		0x8c,
		0xe4,
		0x93,
		0x12,
		0x0e,
		0xf5,
		0xc3,
		0x78,
		0xc2,
		0x96,
		0xee,
		0x18,
		0x96,
		0x50,
		0x0d,
		0x78,
		0xbc,
		0xe6,
		0x78,
		0xba,
		0xf6,
		0x78,
		0xc1,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0x78,
		0xb6,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xc3,
		0x78,
		0xc2,
		0x96,
		0xff,
		0xee,
		0x18,
		0x96,
		0x78,
		0xc3,
		0xf6,
		0x08,
		0xa6,
		0x07,
		0x90,
		0x0e,
		0x96,
		0xe4,
		0x18,
		0x12,
		0x0e,
		0xb8,
		0x40,
		0x02,
		0xd2,
		0x37,
		0x78,
		0xbc,
		0xe6,
		0x08,
		0x26,
		0x08,
		0xf6,
		0xe5,
		0x1f,
		0x64,
		0x01,
		0x70,
		0x7a,
		0xe6,
		0xc3,
		0x78,
		0xc0,
		0x12,
		0x0e,
		0xa1,
		0x40,
		0x08,
		0x12,
		0x0e,
		0x9c,
		0x50,
		0x03,
		0x02,
		0x04,
		0xf1,
		0x12,
		0x0e,
		0xaf,
		0x40,
		0x04,
		0x7f,
		0xfe,
		0x80,
		0x02,
		0x7f,
		0x02,
		0x78,
		0xbd,
		0xa6,
		0x07,
		0x78,
		0xb9,
		0xe6,
		0x24,
		0x03,
		0x78,
		0xbf,
		0xf6,
		0x78,
		0xb9,
		0xe6,
		0x24,
		0xfd,
		0x78,
		0xc0,
		0xf6,
		0x18,
		0x12,
		0x0e,
		0xb1,
		0x40,
		0x04,
		0xe6,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x00,
		0x12,
		0x0e,
		0xd1,
		0x40,
		0x04,
		0xe6,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x00,
		0x12,
		0x0e,
		0xdd,
		0x50,
		0x04,
		0xe6,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x33,
		0x12,
		0x0e,
		0xe9,
		0x50,
		0x04,
		0xe6,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x33,
		0x12,
		0x0e,
		0xab,
		0x40,
		0x06,
		0x78,
		0xc0,
		0xe6,
		0xff,
		0x80,
		0x04,
		0x78,
		0xbf,
		0xe6,
		0xff,
		0x78,
		0xbe,
		0xa6,
		0x07,
		0x75,
		0x1f,
		0x02,
		0x78,
		0xb8,
		0x76,
		0x01,
		0x02,
		0x04,
		0xf1,
		0xe5,
		0x1f,
		0x64,
		0x02,
		0x70,
		0x77,
		0x78,
		0xbe,
		0xe6,
		0xff,
		0xc3,
		0x78,
		0xc0,
		0x12,
		0x0e,
		0xa2,
		0x40,
		0x05,
		0x12,
		0x0e,
		0x9c,
		0x40,
		0x64,
		0x12,
		0x0e,
		0xaf,
		0x40,
		0x04,
		0x7f,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x01,
		0x78,
		0xbd,
		0xa6,
		0x07,
		0x78,
		0xb9,
		0xe6,
		0x04,
		0x78,
		0xbf,
		0xf6,
		0x78,
		0xb9,
		0xe6,
		0x14,
		0x78,
		0xc0,
		0xf6,
		0x18,
		0x12,
		0x0e,
		0xd6,
		0x40,
		0x04,
		0xe6,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x00,
		0x12,
		0x0e,
		0xd1,
		0x40,
		0x04,
		0xe6,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x00,
		0x12,
		0x0e,
		0xdd,
		0x50,
		0x04,
		0xe6,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x33,
		0x12,
		0x0e,
		0xe9,
		0x50,
		0x04,
		0xe6,
		0xff,
		0x80,
		0x02,
		0x7f,
		0x33,
		0x12,
		0x0e,
		0xab,
		0x40,
		0x06,
		0x78,
		0xc0,
		0xe6,
		0xff,
		0x80,
		0x04,
		0x78,
		0xbf,
		0xe6,
		0xff,
		0x78,
		0xbe,
		0xa6,
		0x07,
		0x75,
		0x1f,
		0x03,
		0x78,
		0xb8,
		0x76,
		0x01,
		0x80,
		0x20,
		0xe5,
		0x1f,
		0x64,
		0x03,
		0x70,
		0x26,
		0x78,
		0xbe,
		0xe6,
		0xff,
		0xc3,
		0x78,
		0xc0,
		0x12,
		0x0e,
		0xa2,
		0x40,
		0x05,
		0x12,
		0x0e,
		0x9c,
		0x40,
		0x09,
		0x78,
		0xb9,
		0xe6,
		0x78,
		0xbe,
		0xf6,
		0x75,
		0x1f,
		0x04,
		0x78,
		0xbe,
		0xe6,
		0x75,
		0xf0,
		0x05,
		0xa4,
		0xf5,
		0x4b,
		0x02,
		0x0b,
		0x39,
		0xe5,
		0x1f,
		0x64,
		0x04,
		0x70,
		0x1e,
		0x90,
		0x0e,
		0x95,
		0x78,
		0xc3,
		0x12,
		0x0e,
		0xb8,
		0x40,
		0x04,
		0xd2,
		0x37,
		0x80,
		0x0d,
		0x90,
		0x0e,
		0x97,
		0xe4,
		0x93,
		0xff,
		0x60,
		0x05,
		0xf5,
		0x4b,
		0x12,
		0x0b,
		0x39,
		0x75,
		0x1f,
		0x05,
		0x22,
		0xef,
		0x8d,
		0xf0,
		0xa4,
		0xa8,
		0xf0,
		0xcf,
		0x8c,
		0xf0,
		0xa4,
		0x28,
		0xce,
		0x8d,
		0xf0,
		0xa4,
		0x2e,
		0xfe,
		0x22,
		0xbc,
		0x00,
		0x0b,
		0xbe,
		0x00,
		0x29,
		0xef,
		0x8d,
		0xf0,
		0x84,
		0xff,
		0xad,
		0xf0,
		0x22,
		0xe4,
		0xcc,
		0xf8,
		0x75,
		0xf0,
		0x08,
		0xef,
		0x2f,
		0xff,
		0xee,
		0x33,
		0xfe,
		0xec,
		0x33,
		0xfc,
		0xee,
		0x9d,
		0xec,
		0x98,
		0x40,
		0x05,
		0xfc,
		0xee,
		0x9d,
		0xfe,
		0x0f,
		0xd5,
		0xf0,
		0xe9,
		0xe4,
		0xce,
		0xfd,
		0x22,
		0xed,
		0xf8,
		0xf5,
		0xf0,
		0xee,
		0x84,
		0x20,
		0xd2,
		0x1c,
		0xfe,
		0xad,
		0xf0,
		0x75,
		0xf0,
		0x08,
		0xef,
		0x2f,
		0xff,
		0xed,
		0x33,
		0xfd,
		0x40,
		0x07,
		0x98,
		0x50,
		0x06,
		0xd5,
		0xf0,
		0xf2,
		0x22,
		0xc3,
		0x98,
		0xfd,
		0x0f,
		0xd5,
		0xf0,
		0xea,
		0x22,
		0xe8,
		0x8f,
		0xf0,
		0xa4,
		0xcc,
		0x8b,
		0xf0,
		0xa4,
		0x2c,
		0xfc,
		0xe9,
		0x8e,
		0xf0,
		0xa4,
		0x2c,
		0xfc,
		0x8a,
		0xf0,
		0xed,
		0xa4,
		0x2c,
		0xfc,
		0xea,
		0x8e,
		0xf0,
		0xa4,
		0xcd,
		0xa8,
		0xf0,
		0x8b,
		0xf0,
		0xa4,
		0x2d,
		0xcc,
		0x38,
		0x25,
		0xf0,
		0xfd,
		0xe9,
		0x8f,
		0xf0,
		0xa4,
		0x2c,
		0xcd,
		0x35,
		0xf0,
		0xfc,
		0xeb,
		0x8e,
		0xf0,
		0xa4,
		0xfe,
		0xa9,
		0xf0,
		0xeb,
		0x8f,
		0xf0,
		0xa4,
		0xcf,
		0xc5,
		0xf0,
		0x2e,
		0xcd,
		0x39,
		0xfe,
		0xe4,
		0x3c,
		0xfc,
		0xea,
		0xa4,
		0x2d,
		0xce,
		0x35,
		0xf0,
		0xfd,
		0xe4,
		0x3c,
		0xfc,
		0x22,
		0x75,
		0xf0,
		0x08,
		0x75,
		0x82,
		0x00,
		0xef,
		0x2f,
		0xff,
		0xee,
		0x33,
		0xfe,
		0xcd,
		0x33,
		0xcd,
		0xcc,
		0x33,
		0xcc,
		0xc5,
		0x82,
		0x33,
		0xc5,
		0x82,
		0x9b,
		0xed,
		0x9a,
		0xec,
		0x99,
		0xe5,
		0x82,
		0x98,
		0x40,
		0x0c,
		0xf5,
		0x82,
		0xee,
		0x9b,
		0xfe,
		0xed,
		0x9a,
		0xfd,
		0xec,
		0x99,
		0xfc,
		0x0f,
		0xd5,
		0xf0,
		0xd6,
		0xe4,
		0xce,
		0xfb,
		0xe4,
		0xcd,
		0xfa,
		0xe4,
		0xcc,
		0xf9,
		0xa8,
		0x82,
		0x22,
		0xb8,
		0x00,
		0xc1,
		0xb9,
		0x00,
		0x59,
		0xba,
		0x00,
		0x2d,
		0xec,
		0x8b,
		0xf0,
		0x84,
		0xcf,
		0xce,
		0xcd,
		0xfc,
		0xe5,
		0xf0,
		0xcb,
		0xf9,
		0x78,
		0x18,
		0xef,
		0x2f,
		0xff,
		0xee,
		0x33,
		0xfe,
		0xed,
		0x33,
		0xfd,
		0xec,
		0x33,
		0xfc,
		0xeb,
		0x33,
		0xfb,
		0x10,
		0xd7,
		0x03,
		0x99,
		0x40,
		0x04,
		0xeb,
		0x99,
		0xfb,
		0x0f,
		0xd8,
		0xe5,
		0xe4,
		0xf9,
		0xfa,
		0x22,
		0x78,
		0x18,
		0xef,
		0x2f,
		0xff,
		0xee,
		0x33,
		0xfe,
		0xed,
		0x33,
		0xfd,
		0xec,
		0x33,
		0xfc,
		0xc9,
		0x33,
		0xc9,
		0x10,
		0xd7,
		0x05,
		0x9b,
		0xe9,
		0x9a,
		0x40,
		0x07,
		0xec,
		0x9b,
		0xfc,
		0xe9,
		0x9a,
		0xf9,
		0x0f,
		0xd8,
		0xe0,
		0xe4,
		0xc9,
		0xfa,
		0xe4,
		0xcc,
		0xfb,
		0x22,
		0x75,
		0xf0,
		0x10,
		0xef,
		0x2f,
		0xff,
		0xee,
		0x33,
		0xfe,
		0xed,
		0x33,
		0xfd,
		0xcc,
		0x33,
		0xcc,
		0xc8,
		0x33,
		0xc8,
		0x10,
		0xd7,
		0x07,
		0x9b,
		0xec,
		0x9a,
		0xe8,
		0x99,
		0x40,
		0x0a,
		0xed,
		0x9b,
		0xfd,
		0xec,
		0x9a,
		0xfc,
		0xe8,
		0x99,
		0xf8,
		0x0f,
		0xd5,
		0xf0,
		0xda,
		0xe4,
		0xcd,
		0xfb,
		0xe4,
		0xcc,
		0xfa,
		0xe4,
		0xc8,
		0xf9,
		0x22,
		0xeb,
		0x9f,
		0xf5,
		0xf0,
		0xea,
		0x9e,
		0x42,
		0xf0,
		0xe9,
		0x9d,
		0x42,
		0xf0,
		0xe8,
		0x9c,
		0x45,
		0xf0,
		0x22,
		0xe8,
		0x60,
		0x0f,
		0xec,
		0xc3,
		0x13,
		0xfc,
		0xed,
		0x13,
		0xfd,
		0xee,
		0x13,
		0xfe,
		0xef,
		0x13,
		0xff,
		0xd8,
		0xf1,
		0x22,
		0xe8,
		0x60,
		0x0f,
		0xef,
		0xc3,
		0x33,
		0xff,
		0xee,
		0x33,
		0xfe,
		0xed,
		0x33,
		0xfd,
		0xec,
		0x33,
		0xfc,
		0xd8,
		0xf1,
		0x22,
		0xe4,
		0x93,
		0xfc,
		0x74,
		0x01,
		0x93,
		0xfd,
		0x74,
		0x02,
		0x93,
		0xfe,
		0x74,
		0x03,
		0x93,
		0xff,
		0x22,
		0xe6,
		0xfb,
		0x08,
		0xe6,
		0xf9,
		0x08,
		0xe6,
		0xfa,
		0x08,
		0xe6,
		0xcb,
		0xf8,
		0x22,
		0xec,
		0xf6,
		0x08,
		0xed,
		0xf6,
		0x08,
		0xee,
		0xf6,
		0x08,
		0xef,
		0xf6,
		0x22,
		0xa4,
		0x25,
		0x82,
		0xf5,
		0x82,
		0xe5,
		0xf0,
		0x35,
		0x83,
		0xf5,
		0x83,
		0x22,
		0xd0,
		0x83,
		0xd0,
		0x82,
		0xf8,
		0xe4,
		0x93,
		0x70,
		0x12,
		0x74,
		0x01,
		0x93,
		0x70,
		0x0d,
		0xa3,
		0xa3,
		0x93,
		0xf8,
		0x74,
		0x01,
		0x93,
		0xf5,
		0x82,
		0x88,
		0x83,
		0xe4,
		0x73,
		0x74,
		0x02,
		0x93,
		0x68,
		0x60,
		0xef,
		0xa3,
		0xa3,
		0xa3,
		0x80,
		0xdf,
		0x90,
		0x38,
		0x04,
		0x78,
		0x52,
		0x12,
		0x0b,
		0x0f,
		0x90,
		0x38,
		0x00,
		0xe0,
		0xfe,
		0xa3,
		0xe0,
		0xfd,
		0xed,
		0xff,
		0xc3,
		0x12,
		0x0a,
		0xb0,
		0x90,
		0x38,
		0x10,
		0x12,
		0x0a,
		0xa4,
		0x90,
		0x38,
		0x06,
		0x78,
		0x54,
		0x12,
		0x0b,
		0x0f,
		0x90,
		0x38,
		0x02,
		0xe0,
		0xfe,
		0xa3,
		0xe0,
		0xfd,
		0xed,
		0xff,
		0xc3,
		0x12,
		0x0a,
		0xb0,
		0x90,
		0x38,
		0x12,
		0x12,
		0x0a,
		0xa4,
		0xa3,
		0xe0,
		0xb4,
		0x31,
		0x07,
		0x78,
		0x52,
		0x79,
		0x52,
		0x12,
		0x0b,
		0x2f,
		0x90,
		0x38,
		0x14,
		0xe0,
		0xb4,
		0x71,
		0x15,
		0x78,
		0x52,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0x78,
		0x02,
		0xce,
		0xc3,
		0x13,
		0xce,
		0x13,
		0xd8,
		0xf9,
		0x79,
		0x53,
		0xf7,
		0xee,
		0x19,
		0xf7,
		0x90,
		0x38,
		0x15,
		0xe0,
		0xb4,
		0x31,
		0x07,
		0x78,
		0x54,
		0x79,
		0x54,
		0x12,
		0x0b,
		0x2f,
		0x90,
		0x38,
		0x15,
		0xe0,
		0xb4,
		0x71,
		0x15,
		0x78,
		0x54,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0x78,
		0x02,
		0xce,
		0xc3,
		0x13,
		0xce,
		0x13,
		0xd8,
		0xf9,
		0x79,
		0x55,
		0xf7,
		0xee,
		0x19,
		0xf7,
		0x79,
		0x52,
		0x12,
		0x0a,
		0xeb,
		0x09,
		0x12,
		0x0a,
		0xeb,
		0xaf,
		0x47,
		0x12,
		0x0a,
		0xc4,
		0xe5,
		0x44,
		0xfb,
		0x7a,
		0x00,
		0xfd,
		0x7c,
		0x00,
		0x12,
		0x05,
		0x34,
		0x78,
		0x5a,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0xaf,
		0x45,
		0x12,
		0x0a,
		0xc4,
		0xad,
		0x03,
		0x7c,
		0x00,
		0x12,
		0x05,
		0x34,
		0x78,
		0x56,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0xaf,
		0x48,
		0x78,
		0x54,
		0x12,
		0x0a,
		0xc6,
		0xe5,
		0x43,
		0xfb,
		0xfd,
		0x7c,
		0x00,
		0x12,
		0x05,
		0x34,
		0x78,
		0x5c,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0xaf,
		0x46,
		0x7e,
		0x00,
		0x78,
		0x54,
		0x12,
		0x0a,
		0xc8,
		0xad,
		0x03,
		0x7c,
		0x00,
		0x12,
		0x05,
		0x34,
		0x78,
		0x58,
		0xa6,
		0x06,
		0x08,
		0xa6,
		0x07,
		0xc3,
		0x78,
		0x5b,
		0xe6,
		0x94,
		0x08,
		0x18,
		0xe6,
		0x94,
		0x00,
		0x50,
		0x05,
		0x76,
		0x00,
		0x08,
		0x76,
		0x08,
		0xc3,
		0x78,
		0x5d,
		0xe6,
		0x94,
		0x08,
		0x18,
		0xe6,
		0x94,
		0x00,
		0x50,
		0x05,
		0x76,
		0x00,
		0x08,
		0x76,
		0x08,
		0x78,
		0x5a,
		0x12,
		0x0a,
		0xd8,
		0xff,
		0xd3,
		0x78,
		0x57,
		0xe6,
		0x9f,
		0x18,
		0xe6,
		0x9e,
		0x40,
		0x0e,
		0x78,
		0x5a,
		0xe6,
		0x13,
		0xfe,
		0x08,
		0xe6,
		0x78,
		0x57,
		0x12,
		0x0b,
		0x1a,
		0x80,
		0x04,
		0x7e,
		0x00,
		0x7f,
		0x00,
		0x78,
		0x5e,
		0x12,
		0x0a,
		0xd0,
		0xff,
		0xd3,
		0x78,
		0x59,
		0xe6,
		0x9f,
		0x18,
		0xe6,
		0x9e,
		0x40,
		0x0e,
		0x78,
		0x5c,
		0xe6,
		0x13,
		0xfe,
		0x08,
		0xe6,
		0x78,
		0x59,
		0x12,
		0x0b,
		0x1a,
		0x80,
		0x04,
		0x7e,
		0x00,
		0x7f,
		0x00,
		0xe4,
		0xfc,
		0xfd,
		0x78,
		0x62,
		0x12,
		0x06,
		0xfa,
		0x78,
		0x5a,
		0x12,
		0x0a,
		0xd8,
		0x78,
		0x57,
		0x26,
		0xff,
		0xee,
		0x18,
		0x36,
		0xfe,
		0x78,
		0x66,
		0x12,
		0x0a,
		0xd0,
		0x78,
		0x59,
		0x26,
		0xff,
		0xee,
		0x18,
		0x36,
		0xfe,
		0xe4,
		0xfc,
		0xfd,
		0x78,
		0x6a,
		0x12,
		0x06,
		0xfa,
		0x12,
		0x0a,
		0xe0,
		0x78,
		0x66,
		0x12,
		0x06,
		0xed,
		0xd3,
		0x12,
		0x06,
		0xa6,
		0x40,
		0x08,
		0x12,
		0x0a,
		0xe0,
		0x78,
		0x66,
		0x12,
		0x06,
		0xfa,
		0x78,
		0x54,
		0x12,
		0x0a,
		0xe2,
		0x78,
		0x6a,
		0x12,
		0x06,
		0xed,
		0xd3,
		0x12,
		0x06,
		0xa6,
		0x40,
		0x0a,
		0x78,
		0x54,
		0x12,
		0x0a,
		0xe2,
		0x78,
		0x6a,
		0x12,
		0x06,
		0xfa,
		0x78,
		0x61,
		0xe6,
		0x90,
		0x60,
		0x01,
		0xf0,
		0x78,
		0x65,
		0xe6,
		0xa3,
		0xf0,
		0x78,
		0x69,
		0xe6,
		0xa3,
		0xf0,
		0x78,
		0x55,
		0xe6,
		0xa3,
		0xf0,
		0x7d,
		0x01,
		0x78,
		0x61,
		0x12,
		0x0a,
		0xfb,
		0x24,
		0x01,
		0x12,
		0x0a,
		0xb8,
		0x78,
		0x65,
		0x12,
		0x0a,
		0xfb,
		0x24,
		0x02,
		0x12,
		0x0a,
		0xb8,
		0x78,
		0x69,
		0x12,
		0x0a,
		0xfb,
		0x24,
		0x03,
		0x12,
		0x0a,
		0xb8,
		0x78,
		0x6d,
		0x12,
		0x0a,
		0xfb,
		0x24,
		0x04,
		0x12,
		0x0a,
		0xb8,
		0x0d,
		0xbd,
		0x05,
		0xd4,
		0x22,
		0xc0,
		0xe0,
		0xc0,
		0x83,
		0xc0,
		0x82,
		0xc0,
		0xd0,
		0x90,
		0x3f,
		0x0c,
		0xe0,
		0xf5,
		0x32,
		0xe5,
		0x32,
		0x30,
		0xe3,
		0x74,
		0x30,
		0x36,
		0x66,
		0x90,
		0x60,
		0x19,
		0xe0,
		0xf5,
		0x0a,
		0xa3,
		0xe0,
		0xf5,
		0x0b,
		0x90,
		0x60,
		0x1d,
		0xe0,
		0xf5,
		0x14,
		0xa3,
		0xe0,
		0xf5,
		0x15,
		0x90,
		0x60,
		0x21,
		0xe0,
		0xf5,
		0x0c,
		0xa3,
		0xe0,
		0xf5,
		0x0d,
		0x90,
		0x60,
		0x29,
		0xe0,
		0xf5,
		0x0e,
		0xa3,
		0xe0,
		0xf5,
		0x0f,
		0x90,
		0x60,
		0x31,
		0xe0,
		0xf5,
		0x10,
		0xa3,
		0xe0,
		0xf5,
		0x11,
		0x90,
		0x60,
		0x39,
		0xe0,
		0xf5,
		0x12,
		0xa3,
		0xe0,
		0xf5,
		0x13,
		0x30,
		0x01,
		0x06,
		0x30,
		0x33,
		0x03,
		0xd3,
		0x80,
		0x01,
		0xc3,
		0x92,
		0x09,
		0x30,
		0x02,
		0x06,
		0x30,
		0x33,
		0x03,
		0xd3,
		0x80,
		0x01,
		0xc3,
		0x92,
		0x0a,
		0x30,
		0x33,
		0x0c,
		0x30,
		0x03,
		0x09,
		0x20,
		0x02,
		0x06,
		0x20,
		0x01,
		0x03,
		0xd3,
		0x80,
		0x01,
		0xc3,
		0x92,
		0x0b,
		0x90,
		0x30,
		0x01,
		0xe0,
		0x44,
		0x40,
		0xf0,
		0xe0,
		0x54,
		0xbf,
		0xf0,
		0xe5,
		0x32,
		0x30,
		0xe1,
		0x14,
		0x30,
		0x34,
		0x11,
		0x90,
		0x30,
		0x22,
		0xe0,
		0xf5,
		0x08,
		0xe4,
		0xf0,
		0x30,
		0x00,
		0x03,
		0xd3,
		0x80,
		0x01,
		0xc3,
		0x92,
		0x08,
		0xe5,
		0x32,
		0x30,
		0xe5,
		0x12,
		0x90,
		0x56,
		0xa1,
		0xe0,
		0xf5,
		0x09,
		0x30,
		0x31,
		0x09,
		0x30,
		0x05,
		0x03,
		0xd3,
		0x80,
		0x01,
		0xc3,
		0x92,
		0x0d,
		0x90,
		0x3f,
		0x0c,
		0xe5,
		0x32,
		0xf0,
		0xd0,
		0xd0,
		0xd0,
		0x82,
		0xd0,
		0x83,
		0xd0,
		0xe0,
		0x32,
		0x85,
		0x08,
		0x41,
		0x90,
		0x30,
		0x24,
		0xe0,
		0xf5,
		0x3d,
		0xa3,
		0xe0,
		0xf5,
		0x3e,
		0xa3,
		0xe0,
		0xf5,
		0x3f,
		0xa3,
		0xe0,
		0xf5,
		0x40,
		0xa3,
		0xe0,
		0xf5,
		0x3c,
		0xd2,
		0x34,
		0xe5,
		0x41,
		0x12,
		0x07,
		0x12,
		0x0a,
		0x33,
		0x03,
		0x0a,
		0x40,
		0x04,
		0x0a,
		0x51,
		0x05,
		0x0a,
		0x54,
		0x06,
		0x0a,
		0x5d,
		0x08,
		0x0a,
		0x6d,
		0x12,
		0x0a,
		0x72,
		0x1a,
		0x0a,
		0x7d,
		0x1b,
		0x0a,
		0x6d,
		0x80,
		0x0a,
		0x6d,
		0x81,
		0x0a,
		0x85,
		0xec,
		0x00,
		0x00,
		0x0a,
		0xa3,
		0x12,
		0x0f,
		0xd2,
		0xd2,
		0x36,
		0xd2,
		0x01,
		0xc2,
		0x02,
		0x12,
		0x0f,
		0xd7,
		0x22,
		0xd2,
		0x33,
		0xd2,
		0x36,
		0xe5,
		0x3d,
		0xd3,
		0x94,
		0x00,
		0x40,
		0x03,
		0x12,
		0x0f,
		0xd2,
		0xd2,
		0x03,
		0x22,
		0xd2,
		0x03,
		0x22,
		0xc2,
		0x03,
		0x20,
		0x01,
		0x4a,
		0x30,
		0x02,
		0x2c,
		0x22,
		0xc2,
		0x01,
		0xc2,
		0x02,
		0xc2,
		0x03,
		0x12,
		0x0d,
		0x39,
		0x75,
		0x1e,
		0x70,
		0xd2,
		0x35,
		0x80,
		0x1b,
		0x12,
		0x0b,
		0xcc,
		0x80,
		0x16,
		0x85,
		0x40,
		0x4a,
		0x85,
		0x3c,
		0x4b,
		0x12,
		0x0b,
		0x39,
		0x80,
		0x0b,
		0x85,
		0x4a,
		0x40,
		0x85,
		0x4b,
		0x3c,
		0x80,
		0x03,
		0x12,
		0x0f,
		0x00,
		0x90,
		0x30,
		0x24,
		0xe5,
		0x3d,
		0xf0,
		0xa3,
		0xe5,
		0x3e,
		0xf0,
		0xa3,
		0xe5,
		0x3f,
		0xf0,
		0xa3,
		0xe5,
		0x40,
		0xf0,
		0xa3,
		0xe5,
		0x3c,
		0xf0,
		0x90,
		0x30,
		0x23,
		0xe4,
		0xf0,
		0x22,
		0xe0,
		0xa3,
		0xe0,
		0x75,
		0xf0,
		0x02,
		0xa4,
		0xff,
		0xae,
		0xf0,
		0xc3,
		0x08,
		0xe6,
		0x9f,
		0xf6,
		0x18,
		0xe6,
		0x9e,
		0xf6,
		0x22,
		0xff,
		0xe5,
		0xf0,
		0x34,
		0x60,
		0x8f,
		0x82,
		0xf5,
		0x83,
		0xec,
		0xf0,
		0x22,
		0x78,
		0x52,
		0x7e,
		0x00,
		0xe6,
		0xfc,
		0x08,
		0xe6,
		0xfd,
		0x02,
		0x05,
		0x22,
		0xe4,
		0xfc,
		0xfd,
		0x12,
		0x06,
		0xfa,
		0x78,
		0x5c,
		0xe6,
		0xc3,
		0x13,
		0xfe,
		0x08,
		0xe6,
		0x13,
		0x22,
		0x78,
		0x52,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0xe4,
		0xfc,
		0xfd,
		0x22,
		0xe7,
		0xc4,
		0xf8,
		0x54,
		0xf0,
		0xc8,
		0x68,
		0xf7,
		0x09,
		0xe7,
		0xc4,
		0x54,
		0x0f,
		0x48,
		0xf7,
		0x22,
		0xe6,
		0xfc,
		0xed,
		0x75,
		0xf0,
		0x04,
		0xa4,
		0x22,
		0x12,
		0x06,
		0xdd,
		0x8f,
		0x48,
		0x8e,
		0x47,
		0x8d,
		0x46,
		0x8c,
		0x45,
		0x22,
		0xe0,
		0xfe,
		0xa3,
		0xe0,
		0xfd,
		0xee,
		0xf6,
		0xed,
		0x08,
		0xf6,
		0x22,
		0x13,
		0xff,
		0xc3,
		0xe6,
		0x9f,
		0xff,
		0x18,
		0xe6,
		0x9e,
		0xfe,
		0x22,
		0xfb,
		0xd3,
		0xed,
		0x9b,
		0x74,
		0x80,
		0xf8,
		0x6c,
		0x98,
		0x22,
		0xe6,
		0xc3,
		0x13,
		0xf7,
		0x08,
		0xe6,
		0x13,
		0x09,
		0xf7,
		0x22,
		0x90,
		0x0e,
		0x7e,
		0xe4,
		0x93,
		0xfe,
		0x74,
		0x01,
		0x93,
		0xff,
		0xc3,
		0x90,
		0x0e,
		0x7c,
		0x74,
		0x01,
		0x93,
		0x9f,
		0xff,
		0xe4,
		0x93,
		0x9e,
		0xfe,
		0xe4,
		0x8f,
		0x3b,
		0x8e,
		0x3a,
		0xf5,
		0x39,
		0xf5,
		0x38,
		0xab,
		0x3b,
		0xaa,
		0x3a,
		0xa9,
		0x39,
		0xa8,
		0x38,
		0xaf,
		0x4b,
		0xfc,
		0xfd,
		0xfe,
		0x12,
		0x05,
		0x89,
		0x12,
		0x0f,
		0x91,
		0xe4,
		0x7b,
		0xff,
		0xfa,
		0xf9,
		0xf8,
		0x12,
		0x06,
		0x14,
		0x12,
		0x0f,
		0x91,
		0x90,
		0x0e,
		0x69,
		0xe4,
		0x12,
		0x0f,
		0xa6,
		0x12,
		0x0f,
		0x91,
		0xe4,
		0x85,
		0x4a,
		0x37,
		0xf5,
		0x36,
		0xf5,
		0x35,
		0xf5,
		0x34,
		0xaf,
		0x37,
		0xae,
		0x36,
		0xad,
		0x35,
		0xac,
		0x34,
		0xa3,
		0x12,
		0x0f,
		0xa6,
		0x8f,
		0x37,
		0x8e,
		0x36,
		0x8d,
		0x35,
		0x8c,
		0x34,
		0xe5,
		0x3b,
		0x45,
		0x37,
		0xf5,
		0x3b,
		0xe5,
		0x3a,
		0x45,
		0x36,
		0xf5,
		0x3a,
		0xe5,
		0x39,
		0x45,
		0x35,
		0xf5,
		0x39,
		0xe5,
		0x38,
		0x45,
		0x34,
		0xf5,
		0x38,
		0xe4,
		0xf5,
		0x22,
		0xf5,
		0x23,
		0x85,
		0x3b,
		0x31,
		0x85,
		0x3a,
		0x30,
		0x85,
		0x39,
		0x2f,
		0x85,
		0x38,
		0x2e,
		0x02,
		0x0f,
		0x63,
		0xe5,
		0x3c,
		0xd3,
		0x94,
		0x01,
		0x40,
		0x0b,
		0x90,
		0x0e,
		0x88,
		0x12,
		0x0b,
		0x03,
		0x90,
		0x0e,
		0x86,
		0x80,
		0x09,
		0x90,
		0x0e,
		0x82,
		0x12,
		0x0b,
		0x03,
		0x90,
		0x0e,
		0x80,
		0xe4,
		0x93,
		0xf5,
		0x44,
		0xa3,
		0xe4,
		0x93,
		0xf5,
		0x43,
		0xe5,
		0x3c,
		0xd3,
		0x94,
		0x00,
		0x40,
		0x06,
		0x85,
		0x3d,
		0x45,
		0x85,
		0x3e,
		0x46,
		0xe5,
		0x47,
		0xc3,
		0x13,
		0xff,
		0xe5,
		0x45,
		0xc3,
		0x9f,
		0x50,
		0x02,
		0x8f,
		0x45,
		0xe5,
		0x48,
		0xc3,
		0x13,
		0xff,
		0xe5,
		0x46,
		0xc3,
		0x9f,
		0x50,
		0x02,
		0x8f,
		0x46,
		0xe5,
		0x47,
		0xc3,
		0x13,
		0xff,
		0xfd,
		0xe5,
		0x45,
		0x2d,
		0xfd,
		0xe4,
		0x33,
		0xfc,
		0xe5,
		0x44,
		0x12,
		0x0b,
		0x25,
		0x40,
		0x05,
		0xe5,
		0x44,
		0x9f,
		0xf5,
		0x45,
		0xe5,
		0x48,
		0xc3,
		0x13,
		0xff,
		0xfd,
		0xe5,
		0x46,
		0x2d,
		0xfd,
		0xe4,
		0x33,
		0xfc,
		0xe5,
		0x43,
		0x12,
		0x0b,
		0x25,
		0x40,
		0x05,
		0xe5,
		0x43,
		0x9f,
		0xf5,
		0x46,
		0x02,
		0x07,
		0x38,
		0xad,
		0x39,
		0xac,
		0x38,
		0xfa,
		0xf9,
		0xf8,
		0x12,
		0x05,
		0x89,
		0x8f,
		0x3b,
		0x8e,
		0x3a,
		0x8d,
		0x39,
		0x8c,
		0x38,
		0xab,
		0x37,
		0xaa,
		0x36,
		0xa9,
		0x35,
		0xa8,
		0x34,
		0x22,
		0x90,
		0x0e,
		0x8c,
		0xe4,
		0x93,
		0x25,
		0xe0,
		0x24,
		0x0a,
		0xf8,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0x22,
		0x93,
		0xff,
		0xe4,
		0xfc,
		0xfd,
		0xfe,
		0x12,
		0x05,
		0x89,
		0x8f,
		0x37,
		0x8e,
		0x36,
		0x8d,
		0x35,
		0x8c,
		0x34,
		0x22,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0xe4,
		0x8f,
		0x37,
		0x8e,
		0x36,
		0xf5,
		0x35,
		0xf5,
		0x34,
		0x22,
		0xef,
		0x25,
		0xe0,
		0x24,
		0x4e,
		0xf8,
		0xe6,
		0xfc,
		0x08,
		0xe6,
		0xfd,
		0x22,
		0xd3,
		0x79,
		0x81,
		0xe7,
		0x78,
		0x7f,
		0x96,
		0x19,
		0xe7,
		0x18,
		0x96,
		0x22,
		0x78,
		0x89,
		0xef,
		0x26,
		0xf6,
		0x18,
		0xe4,
		0x36,
		0xf6,
		0x22,
		0xe4,
		0x8f,
		0x3b,
		0x8e,
		0x3a,
		0xf5,
		0x39,
		0xf5,
		0x38,
		0x22,
		0x75,
		0x89,
		0x03,
		0x75,
		0xa8,
		0x01,
		0x75,
		0xb8,
		0x04,
		0x75,
		0x34,
		0xff,
		0x75,
		0x35,
		0x0e,
		0x75,
		0x36,
		0x15,
		0x75,
		0x37,
		0x0d,
		0x12,
		0x0d,
		0xaa,
		0x12,
		0x00,
		0x09,
		0x12,
		0x0b,
		0xcc,
		0x12,
		0x00,
		0x06,
		0xd2,
		0x00,
		0xd2,
		0x34,
		0xd2,
		0xaf,
		0x75,
		0x34,
		0xff,
		0x75,
		0x35,
		0x0e,
		0x75,
		0x36,
		0x49,
		0x75,
		0x37,
		0x03,
		0x12,
		0x0d,
		0xaa,
		0x30,
		0x08,
		0x09,
		0xc2,
		0x34,
		0x12,
		0x09,
		0xee,
		0xc2,
		0x08,
		0xd2,
		0x34,
		0x30,
		0x0b,
		0x09,
		0xc2,
		0x36,
		0x12,
		0x00,
		0x0e,
		0xc2,
		0x0b,
		0xd2,
		0x36,
		0x30,
		0x09,
		0x09,
		0xc2,
		0x36,
		0x12,
		0x02,
		0xa7,
		0xc2,
		0x09,
		0xd2,
		0x36,
		0x30,
		0x0e,
		0x03,
		0x12,
		0x07,
		0x38,
		0x30,
		0x35,
		0xd3,
		0x90,
		0x30,
		0x29,
		0xe5,
		0x1e,
		0xf0,
		0xb4,
		0x10,
		0x05,
		0x90,
		0x30,
		0x23,
		0xe4,
		0xf0,
		0xc2,
		0x35,
		0x80,
		0xc1,
		0xe4,
		0xf5,
		0x4b,
		0x90,
		0x0e,
		0x7a,
		0x93,
		0xff,
		0xe4,
		0x8f,
		0x37,
		0xf5,
		0x36,
		0xf5,
		0x35,
		0xf5,
		0x34,
		0xaf,
		0x37,
		0xae,
		0x36,
		0xad,
		0x35,
		0xac,
		0x34,
		0x90,
		0x0e,
		0x6a,
		0x12,
		0x0f,
		0xa6,
		0x8f,
		0x37,
		0x8e,
		0x36,
		0x8d,
		0x35,
		0x8c,
		0x34,
		0x90,
		0x0e,
		0x72,
		0x12,
		0x06,
		0xdd,
		0xef,
		0x45,
		0x37,
		0xf5,
		0x37,
		0xee,
		0x45,
		0x36,
		0xf5,
		0x36,
		0xed,
		0x45,
		0x35,
		0xf5,
		0x35,
		0xec,
		0x45,
		0x34,
		0xf5,
		0x34,
		0xe4,
		0xf5,
		0x22,
		0xf5,
		0x23,
		0x85,
		0x37,
		0x31,
		0x85,
		0x36,
		0x30,
		0x85,
		0x35,
		0x2f,
		0x85,
		0x34,
		0x2e,
		0x12,
		0x0f,
		0x63,
		0xe4,
		0xf5,
		0x22,
		0xf5,
		0x23,
		0x90,
		0x0e,
		0x72,
		0x12,
		0x0f,
		0x9a,
		0x12,
		0x0f,
		0x63,
		0xe4,
		0xf5,
		0x22,
		0xf5,
		0x23,
		0x90,
		0x0e,
		0x6e,
		0x12,
		0x0f,
		0x9a,
		0x02,
		0x0f,
		0x63,
		0xae,
		0x35,
		0xaf,
		0x36,
		0xe4,
		0xfd,
		0xed,
		0xc3,
		0x95,
		0x37,
		0x50,
		0x33,
		0x12,
		0x0f,
		0xec,
		0xe4,
		0x93,
		0xf5,
		0x38,
		0x74,
		0x01,
		0x93,
		0xf5,
		0x39,
		0x45,
		0x38,
		0x60,
		0x23,
		0x85,
		0x39,
		0x82,
		0x85,
		0x38,
		0x83,
		0xe0,
		0xfc,
		0x12,
		0x0f,
		0xec,
		0x74,
		0x03,
		0x93,
		0x52,
		0x04,
		0x12,
		0x0f,
		0xec,
		0x74,
		0x02,
		0x93,
		0x42,
		0x04,
		0x85,
		0x39,
		0x82,
		0x85,
		0x38,
		0x83,
		0xec,
		0xf0,
		0x0d,
		0x80,
		0xc7,
		0x22,
		0xc0,
		0xe0,
		0xc0,
		0x83,
		0xc0,
		0x82,
		0x90,
		0x3f,
		0x0d,
		0xe0,
		0xf5,
		0x33,
		0xe5,
		0x33,
		0xf0,
		0xd0,
		0x82,
		0xd0,
		0x83,
		0xd0,
		0xe0,
		0x32,
		0x12,
		0x04,
		0x13,
		0x10,
		0x01,
		0x03,
		0x4f,
		0x56,
		0x54,
		0x20,
		0x20,
		0x20,
		0x20,
		0x20,
		0x13,
		0x01,
		0x10,
		0x01,
		0x56,
		0x40,
		0x1a,
		0x30,
		0x29,
		0x7e,
		0x00,
		0x30,
		0x04,
		0x20,
		0xdf,
		0x30,
		0x05,
		0x40,
		0xbf,
		0x50,
		0x03,
		0x00,
		0xfd,
		0x50,
		0x27,
		0x01,
		0xfe,
		0x60,
		0x00,
		0x11,
		0x00,
		0x3f,
		0x05,
		0x30,
		0x00,
		0x3f,
		0x06,
		0x22,
		0x00,
		0x3f,
		0x01,
		0x2a,
		0x00,
		0x3f,
		0x02,
		0x00,
		0x00,
		0x36,
		0x06,
		0x07,
		0x00,
		0x3f,
		0x0b,
		0x0f,
		0xf0,
		0x00,
		0x00,
		0x00,
		0x00,
		0x30,
		0x01,
		0x40,
		0xbf,
		0x30,
		0x01,
		0x00,
		0xbf,
		0x30,
		0x29,
		0x70,
		0x00,
		0x3a,
		0x00,
		0x00,
		0xff,
		0x3a,
		0x00,
		0x00,
		0xff,
		0x36,
		0x03,
		0x36,
		0x02,
		0x41,
		0x44,
		0x58,
		0x20,
		0x18,
		0x10,
		0x0a,
		0x04,
		0x04,
		0x00,
		0x03,
		0xff,
		0x64,
		0x00,
		0x00,
		0x80,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x00,
		0x02,
		0x04,
		0x06,
		0x06,
		0x00,
		0x02,
		0x60,
		0x00,
		0x70,
		0x50,
		0x3c,
		0x28,
		0x1e,
		0x10,
		0x10,
		0x50,
		0x2d,
		0x28,
		0x16,
		0x10,
		0x10,
		0x02,
		0x00,
		0x10,
		0x30,
		0x0a,
		0x04,
		0x05,
		0x08,
		0x64,
		0x06,
		0x05,
		0x01,
		0x00,
		0xa5,
		0x5a,
		0x00,
		0x78,
		0xbe,
		0xe6,
		0xd3,
		0x08,
		0xff,
		0xe6,
		0x64,
		0x80,
		0xf8,
		0xef,
		0x64,
		0x80,
		0x98,
		0x22,
		0x78,
		0xc0,
		0xa6,
		0x07,
		0x78,
		0xbd,
		0xd3,
		0xe6,
		0x64,
		0x80,
		0x94,
		0x80,
		0x22,
		0x93,
		0xff,
		0x7e,
		0x00,
		0xe6,
		0xfc,
		0x08,
		0xe6,
		0xfd,
		0x12,
		0x05,
		0x22,
		0x78,
		0xc1,
		0xe6,
		0xfc,
		0x08,
		0xe6,
		0xfd,
		0xd3,
		0xef,
		0x9d,
		0xee,
		0x9c,
		0x22,
		0x78,
		0xbf,
		0xa6,
		0x07,
		0x08,
		0xd3,
		0xe6,
		0x64,
		0x80,
		0x94,
		0x80,
		0x22,
		0x78,
		0xc0,
		0xa6,
		0x07,
		0xc3,
		0x18,
		0xe6,
		0x64,
		0x80,
		0x94,
		0xb3,
		0x22,
		0x78,
		0xbf,
		0xa6,
		0x07,
		0xc3,
		0x08,
		0xe6,
		0x64,
		0x80,
		0x94,
		0xb3,
		0x22,
		0x25,
		0xe0,
		0x24,
		0x0a,
		0xf8,
		0xe6,
		0xfe,
		0x08,
		0xe6,
		0xff,
		0x22,
		0xe5,
		0x40,
		0x24,
		0xf2,
		0xf5,
		0x37,
		0xe5,
		0x3f,
		0x34,
		0x43,
		0xf5,
		0x36,
		0xe5,
		0x3e,
		0x34,
		0xa2,
		0xf5,
		0x35,
		0xe5,
		0x3d,
		0x34,
		0x28,
		0xf5,
		0x34,
		0xe5,
		0x37,
		0xff,
		0xe4,
		0xfe,
		0xfd,
		0xfc,
		0x78,
		0x18,
		0x12,
		0x06,
		0xca,
		0x8f,
		0x40,
		0x8e,
		0x3f,
		0x8d,
		0x3e,
		0x8c,
		0x3d,
		0xe5,
		0x37,
		0x54,
		0xa0,
		0xff,
		0xe5,
		0x36,
		0xfe,
		0xe4,
		0xfd,
		0xfc,
		0x78,
		0x07,
		0x12,
		0x06,
		0xb7,
		0x78,
		0x10,
		0x12,
		0x0f,
		0xac,
		0xe4,
		0xff,
		0xfe,
		0xe5,
		0x35,
		0xfd,
		0xe4,
		0xfc,
		0x78,
		0x0e,
		0x12,
		0x06,
		0xb7,
		0x12,
		0x0f,
		0xaf,
		0xe4,
		0xff,
		0xfe,
		0xfd,
		0xe5,
		0x34,
		0xfc,
		0x78,
		0x18,
		0x12,
		0x06,
		0xb7,
		0x78,
		0x08,
		0x12,
		0x0f,
		0xac,
		0x22,
		0xa2,
		0xaf,
		0x92,
		0x32,
		0xc2,
		0xaf,
		0xe5,
		0x23,
		0x45,
		0x22,
		0x90,
		0x0e,
		0x5d,
		0x60,
		0x0e,
		0x12,
		0x0f,
		0xc7,
		0xe0,
		0xf5,
		0x2c,
		0x12,
		0x0f,
		0xc4,
		0xe0,
		0xf5,
		0x2d,
		0x80,
		0x0c,
		0x12,
		0x0f,
		0xc7,
		0xe5,
		0x30,
		0xf0,
		0x12,
		0x0f,
		0xc4,
		0xe5,
		0x31,
		0xf0,
		0xa2,
		0x32,
		0x92,
		0xaf,
		0x22,
		0x8f,
		0x3b,
		0x8e,
		0x3a,
		0x8d,
		0x39,
		0x8c,
		0x38,
		0x22,
		0x12,
		0x06,
		0xdd,
		0x8f,
		0x31,
		0x8e,
		0x30,
		0x8d,
		0x2f,
		0x8c,
		0x2e,
		0x22,
		0x93,
		0xf9,
		0xf8,
		0x02,
		0x06,
		0xca,
		0x12,
		0x06,
		0xca,
		0xe5,
		0x40,
		0x2f,
		0xf5,
		0x40,
		0xe5,
		0x3f,
		0x3e,
		0xf5,
		0x3f,
		0xe5,
		0x3e,
		0x3d,
		0xf5,
		0x3e,
		0xe5,
		0x3d,
		0x3c,
		0xf5,
		0x3d,
		0x22,
		0x90,
		0x0e,
		0x5f,
		0xe4,
		0x93,
		0xfe,
		0x74,
		0x01,
		0x93,
		0xf5,
		0x82,
		0x8e,
		0x83,
		0x22,
		0xd2,
		0x01,
		0xc2,
		0x02,
		0xe4,
		0xf5,
		0x1f,
		0xf5,
		0x1e,
		0xd2,
		0x35,
		0xd2,
		0x33,
		0x22,
		0x78,
		0x7f,
		0xe4,
		0xf6,
		0xd8,
		0xfd,
		0x75,
		0x81,
		0xcd,
		0x02,
		0x0c,
		0xc4,
		0x8f,
		0x82,
		0x8e,
		0x83,
		0x75,
		0xf0,
		0x04,
		0xed,
		0x02,
		0x07,
		0x06
};

LOCAL int _ov5640_init_firmware(void)
{
	uint32_t i = 0;
	int ret = 0;
	uint32_t init_num = NUMBER_OF_ARRAY(af_firmware);
	uint8_t *reg_ptr = af_firmware;
	uint16_t reg_val_1, reg_val_2;

	SENSOR_PRINT_HIGH("init firmware start!");
	Sensor_WriteReg(0x3000, 0x20);

	for (i = 0; i < 4; i++) {
		ret = Sensor_WriteData(reg_ptr, init_num);

		if (ret != 0) {
			SENSOR_PRINT_ERR("write sensor reg fai, ret : %d", ret);
			continue;
		} else {
			ret = 0;
			break;
		}
	}

	Sensor_WriteReg(0x3022, 0x00);
	Sensor_WriteReg(0x3023, 0x00);
	Sensor_WriteReg(0x3024, 0x00);
	Sensor_WriteReg(0x3025, 0x00);
	Sensor_WriteReg(0x3026, 0x00);
	Sensor_WriteReg(0x3027, 0x00);
	Sensor_WriteReg(0x3028, 0x00);
	Sensor_WriteReg(0x3029, 0x7F);
	Sensor_WriteReg(0x3000, 0x00);

	return ret;
}

LOCAL void OV5640_set_bandingfilter(void)
{
	int preview_VTS;
	int band_step60, max_band60, band_step50, max_band50;

	// read preview PCLK
	preview_sysclk = OV5640_get_sysclk(s_ov5640_resolution_Tab_YUV[SENSOR_MODE_PREVIEW_ONE].xclk_to_sensor);

	// read preview HTS
	preview_hts = OV5640_get_HTS();

	SENSOR_PRINT("preview_sysclk %d, preview_hts %d",
		preview_sysclk,
		preview_hts);
	// read preview VTS
	preview_VTS = OV5640_get_VTS();

	// calculate banding filter
	// 60Hz
	band_step60 = preview_sysclk * 100 / preview_hts * 100 / 120;
	Sensor_WriteReg(0x3a0a, (band_step60 >> 8));
	Sensor_WriteReg(0x3a0b, (band_step60 & 0xff));

	max_band60 = (int)((preview_VTS-4)/band_step60);
	Sensor_WriteReg(0x3a0d, max_band60);

	// 50Hz
	band_step50 = preview_sysclk * 100/preview_hts;
	Sensor_WriteReg(0x3a08, (band_step50 >> 8));
	Sensor_WriteReg(0x3a09, (band_step50 & 0xff));

	max_band50 = (int)((preview_VTS-4)/band_step50);
	Sensor_WriteReg(0x3a0e, max_band50);
}

LOCAL uint32_t _ov5640_ExtFunc(uint32_t ctl_param)
{
	uint32_t rtn = SENSOR_SUCCESS;
	SENSOR_EXT_FUN_PARAM_T_PTR ext_ptr =
		(SENSOR_EXT_FUN_PARAM_T_PTR)ctl_param;
	SENSOR_PRINT("0x%x", ext_ptr->cmd);

	switch (ext_ptr->cmd) {
	case SENSOR_EXT_FUNC_INIT:
		/*OV5640_set_AE_target(52);*/
		OV5640_set_bandingfilter();
		OV5640_set_AF_gain(0);
		rtn = _ov5640_init_firmware();
		break;
	case SENSOR_EXT_FOCUS_START:
		rtn = _ov5640_StartAutoFocus(ctl_param);
		break;
	case SENSOR_EXT_FOCUS_QUIT:
		rtn = _ov5640_QuitAutoFocus();
		break;
	case SENSOR_EXT_EXPOSURE_START:
		rtn = _ov5640_StartExposure(ctl_param);
		break;
	case SENSOR_EXT_EV:
		rtn = _ov5640_SetEV(ctl_param);
		break;
	case SENSOR_EXT_EXPOSURE_SL:
		rtn = _ov5640_saveLoad_exposure(ctl_param);
		break;
	default:
		break;
	}
	return rtn;
}

/*
// Description:
// mode:
//           0:auto
// 	      1:ISO 100
// 	      2:ISO 200
// 	      3:ISO 400
// 	      4:ISO 800
// 	      5:ISO 1600
*/
LOCAL const SENSOR_REG_BITS_T ov5640_iso_tab[][8] =
{
	/*AUTO*/
	{
		{0x3a18, 0x00,0xff}, {0x3a19, 0xb0,0xff}, {0xffff, 0xff,0}
	},
	/*ISO 100*/
	{
		{0x3a18, 0x00,0xff}, {0x3a19, 0x30,0xff}, {0xffff, 0xff,0}
	},
	/*ISO 200*/
	{
		{0x3a18, 0x00,0xff}, {0x3a19, 0x60,0xff}, {0xffff, 0xff,0}
	},
	/*ISO 400*/
	{
		{0x3a18, 0x00,0xff}, {0x3a19, 0x80,0xff}, {0xffff, 0xff,0}
	},
	/*ISO 800*/
	{
		{0x3a18, 0x00,0xff}, {0x3a19, 0xb0,0xff}, {0xffff, 0xff,0}
	},
	/*ISO 1600*/
	{
		{0x3a18, 0x00,0xff}, {0x3a19, 0xf8,0xff}, {0xffff, 0xff,0}
	}
};

LOCAL uint32_t _ov5640_set_iso(uint32_t mode)
{
	uint16_t i=0x00;
	uint32_t reg_bits = 0;
	uint32_t reg_value = 0;
	SENSOR_REG_BITS_T_PTR sensor_reg_ptr=(SENSOR_REG_BITS_T_PTR)ov5640_iso_tab[mode];
	SENSOR_PRINT("mode = %d",mode);
	iso_mode = mode;
	if(mode>5)
		return 0;

	for (i = 0; (0xffff != sensor_reg_ptr[i].reg_addr) || (0xFF!=sensor_reg_ptr[i].reg_value); i++)
	{
		if (0xff == sensor_reg_ptr[i].reg_bits) {
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr, sensor_reg_ptr[i].reg_value);
		} else {
			reg_bits = sensor_reg_ptr[i].reg_bits;
			reg_value = Sensor_ReadReg(sensor_reg_ptr[i].reg_addr);
			reg_value &= ~reg_bits;
			reg_value |= sensor_reg_ptr[i].reg_value;
			Sensor_WriteReg(sensor_reg_ptr[i].reg_addr, (uint16_t)reg_value);
		}
	}

	SENSOR_PRINT("read 0x%x,0x%x", Sensor_ReadReg(0x3a18),Sensor_ReadReg(0x3a19));
	return 0;
}

//static int count = 0;
LOCAL uint32_t _ov5640_check_status(uint32_t param)
{
	return 0;
}

LOCAL uint32_t _ov5640_get_cur_af_gain(void)
{
	int preview_shutter, preview_gain16 = 0;
	uint32_t af_gain = 0;

	preview_shutter = OV5640_get_shutter();
	preview_gain16  = OV5640_get_gain16();
	af_gain = preview_shutter * preview_gain16;

	return af_gain;
}


LOCAL uint32_t _ov5640_flash(uint32_t param)
{
	uint16_t value = 0;
	uint32_t *autoflash;

	autoflash = (uint32_t *) param;
	if (autoflash) {
		//usleep(1000);
		value = Sensor_ReadReg(0x56a1);
		if (value < 16) {
			*autoflash = 1;
		} else {
			*autoflash = 0;
		}
	} else {
		SENSOR_PRINT("  NULL pointer error! ");
		return SENSOR_FAIL;
	}

	SENSOR_PRINT(" value = %d, autoflash = 0x%x, auto_flash_mode",  value, *autoflash);
	return SENSOR_SUCCESS;
}

LOCAL uint32_t _ov5640_StreamOn(uint32_t param)
{
	SENSOR_PRINT("SENSOR_OV5640: StreamOn");

	Sensor_WriteReg(0x4202, 0x00);

	return 0;
}

LOCAL uint32_t _ov5640_StreamOff(uint32_t param)
{
	SENSOR_PRINT("SENSOR_OV5640: StreamOff");

	Sensor_WriteReg(0x4202, 0x0f);

	return 0;
}
